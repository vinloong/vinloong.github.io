"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4927],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>N});var l=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,l,a=function(e,t){if(null==e)return{};var n,l,a={},r=Object.keys(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=l.createContext({}),k=function(e){var t=l.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},m=function(e){var t=k(e.components);return l.createElement(o.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},s=l.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),d=k(n),s=a,N=d["".concat(o,".").concat(s)]||d[s]||u[s]||r;return n?l.createElement(N,p(p({ref:t},m),{},{components:n})):l.createElement(N,p({ref:t},m))}));function N(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,p=new Array(r);p[0]=s;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i[d]="string"==typeof e?e:a,p[1]=i;for(var k=2;k<r;k++)p[k]=n[k];return l.createElement.apply(null,p)}return l.createElement.apply(null,n)}s.displayName="MDXCreateElement"},7090:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>k,contentTitle:()=>i,default:()=>s,frontMatter:()=>p,metadata:()=>o,toc:()=>m});n(7294);var l=n(3905);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},a.apply(this,arguments)}function r(e,t){if(null==e)return{};var n,l,a=function(e,t){if(null==e)return{};var n,l,a={},r=Object.keys(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const p={index:!1,icon:"devops",title:"PromQL start",date:new Date("2022-03-11T00:00:00.000Z"),category:["devops"],tag:["PromQL"]},i="\u6570\u636e\u7c7b\u578b",o={unversionedId:"dev&ops/Prometheus/PromQL",id:"dev&ops/Prometheus/PromQL",title:"PromQL start",description:"\u5728 Prometheus \u7684\u8868\u8fbe\u5f0f\u8bed\u8a00\u4e2d\uff0c\u8868\u8fbe\u5f0f\u6216\u5b50\u8868\u8fbe\u5f0f\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\u7c7b\u578b\u4e4b\u4e00\uff1a",source:"@site/docs/dev&ops/Prometheus/PromQL.md",sourceDirName:"dev&ops/Prometheus",slug:"/dev&ops/Prometheus/PromQL",permalink:"/docs/dev&ops/Prometheus/PromQL",draft:!1,tags:[],version:"current",lastUpdatedAt:1675912862,formattedLastUpdatedAt:"2023\u5e742\u67089\u65e5",frontMatter:{index:!1,icon:"devops",title:"PromQL start",date:"2022-03-11T00:00:00.000Z",category:["devops"],tag:["PromQL"]},sidebar:"dev&ops",previous:{title:"Jenkins \u9047\u5230\u7684\u95ee\u9898\u548c\u89e3\u51b3\u65b9\u6848",permalink:"/docs/dev&ops/Jenkins-faq"},next:{title:"wsl install",permalink:"/docs/dev&ops/WSL2 \u5b89\u88c5\u548c\u4f7f\u7528"}},k={},m=[{value:"\u5b57\u7b26\u4e32",id:"\u5b57\u7b26\u4e32",level:2},{value:"\u6807\u91cf",id:"\u6807\u91cf",level:2},{value:"\u77ac\u65f6\u5411\u91cf\u8fc7\u6ee4\u5668",id:"\u77ac\u65f6\u5411\u91cf\u8fc7\u6ee4\u5668",level:2},{value:"\u533a\u95f4\u5411\u91cf\u8fc7\u6ee4\u5668",id:"\u533a\u95f4\u5411\u91cf\u8fc7\u6ee4\u5668",level:2},{value:"\u65f6\u95f4\u4f4d\u79fb\u64cd\u4f5c",id:"\u65f6\u95f4\u4f4d\u79fb\u64cd\u4f5c",level:2},{value:"\u4e8c\u5143\u8fd0\u7b97\u7b26",id:"\u4e8c\u5143\u8fd0\u7b97\u7b26",level:2},{value:"\u7b97\u672f\u4e8c\u5143\u8fd0\u7b97\u7b26",id:"\u7b97\u672f\u4e8c\u5143\u8fd0\u7b97\u7b26",level:3},{value:"\u5e03\u5c14\u8fd0\u7b97\u7b26",id:"\u5e03\u5c14\u8fd0\u7b97\u7b26",level:3},{value:"\u96c6\u5408\u8fd0\u7b97\u7b26",id:"\u96c6\u5408\u8fd0\u7b97\u7b26",level:3},{value:"\u5339\u914d\u6a21\u5f0f",id:"\u5339\u914d\u6a21\u5f0f",level:2},{value:"\u4e00\u5bf9\u4e00\u5339\u914d",id:"\u4e00\u5bf9\u4e00\u5339\u914d",level:3},{value:"\u591a\u5bf9\u4e00\u548c\u4e00\u5bf9\u591a",id:"\u591a\u5bf9\u4e00\u548c\u4e00\u5bf9\u591a",level:3},{value:"\u805a\u5408\u64cd\u4f5c",id:"\u805a\u5408\u64cd\u4f5c",level:2},{value:"\u4e8c\u5143\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7",id:"\u4e8c\u5143\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7",level:2},{value:"abs()",id:"abs",level:2},{value:"absent()",id:"absent",level:2},{value:"ceil()",id:"ceil",level:2},{value:"changes()",id:"changes",level:2},{value:"clamp_max()",id:"clamp_max",level:2},{value:"clamp_min()",id:"clamp_min",level:2},{value:"day_of_month()",id:"day_of_month",level:2},{value:"day_of_week()",id:"day_of_week",level:2},{value:"days_in_month()",id:"days_in_month",level:2},{value:"delta()",id:"delta",level:2},{value:"deriv()",id:"deriv",level:2},{value:"exp()",id:"exp",level:2},{value:"floor()",id:"floor",level:2},{value:"histogram_quantile()",id:"histogram_quantile",level:2},{value:"\u5931\u6548",id:"\u5931\u6548",level:2},{value:"\u907f\u514d\u6162\u67e5\u8be2\u548c\u9ad8\u8d1f\u8f7d",id:"\u907f\u514d\u6162\u67e5\u8be2\u548c\u9ad8\u8d1f\u8f7d",level:2}],d={toc:m},u="wrapper";function s(e){var{components:t}=e,n=r(e,["components"]);return(0,l.kt)(u,a({},d,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",a({},{id:"\u6570\u636e\u7c7b\u578b"}),"\u6570\u636e\u7c7b\u578b"),(0,l.kt)("p",null,"\u5728 Prometheus \u7684\u8868\u8fbe\u5f0f\u8bed\u8a00\u4e2d\uff0c\u8868\u8fbe\u5f0f\u6216\u5b50\u8868\u8fbe\u5f0f\u5305\u62ec\u4ee5\u4e0b\u56db\u79cd\u7c7b\u578b\u4e4b\u4e00\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u77ac\u65f6\u5411\u91cf\uff08Instant vector\uff09")," - \u4e00\u7ec4\u65f6\u95f4\u5e8f\u5217\uff0c\u6bcf\u4e2a\u65f6\u95f4\u5e8f\u5217\u5305\u542b\u5355\u4e2a\u6837\u672c\uff0c\u5b83\u4eec\u5171\u4eab\u76f8\u540c\u7684\u65f6\u95f4\u6233\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8868\u8fbe\u5f0f\u7684\u8fd4\u56de\u503c\u4e2d\u53ea\u4f1a\u5305\u542b\u8be5\u65f6\u95f4\u5e8f\u5217\u4e2d\u7684\u6700\u65b0\u7684\u4e00\u4e2a\u6837\u672c\u503c\u3002\u800c\u76f8\u5e94\u7684\u8fd9\u6837\u7684\u8868\u8fbe\u5f0f\u79f0\u4e4b\u4e3a",(0,l.kt)("strong",{parentName:"li"},"\u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u533a\u95f4\u5411\u91cf\uff08Range vector\uff09")," - \u4e00\u7ec4\u65f6\u95f4\u5e8f\u5217\uff0c\u6bcf\u4e2a\u65f6\u95f4\u5e8f\u5217\u5305\u542b\u4e00\u6bb5\u65f6\u95f4\u8303\u56f4\u5185\u7684\u6837\u672c\u6570\u636e\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u6807\u91cf\uff08Scalar\uff09")," - \u4e00\u4e2a\u6d6e\u70b9\u578b\u7684\u6570\u636e\u503c\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"\u5b57\u7b26\u4e32\uff08String\uff09")," - \u4e00\u4e2a\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u503c\u3002")),(0,l.kt)("h1",a({},{id:"\u5b57\u9762\u91cf"}),"\u5b57\u9762\u91cf"),(0,l.kt)("h2",a({},{id:"\u5b57\u7b26\u4e32"}),"\u5b57\u7b26\u4e32"),(0,l.kt)("p",null,"\u5b57\u7b26\u4e32\u53ef\u4ee5\u7528\u5355\u5f15\u53f7\u3001\u53cc\u5f15\u53f7\u6216\u53cd\u5f15\u53f7\u6307\u5b9a\u4e3a\u6587\u5b57\u5e38\u91cf\u3002"),(0,l.kt)("p",null,"PromQL \u9075\u5faa\u4e0e Go \u76f8\u540c\u7684\u8f6c\u4e49\u89c4\u5219\u3002\u5728\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u4e2d\uff0c\u7528\u53cd\u659c\u6760\u6765\u8868\u793a\u8f6c\u4e49\u5e8f\u5217\uff0c\u540e\u9762\u53ef\u4ee5\u8ddf ",(0,l.kt)("inlineCode",{parentName:"p"},"a"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"b"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"f"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"n"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"r"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"t"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"v")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"\\"),"\u3002\u7279\u6b8a\u5b57\u7b26\u53ef\u4ee5\u4f7f\u7528\u516b\u8fdb\u5236\uff08",(0,l.kt)("inlineCode",{parentName:"p"},"\\nnn"),"\uff09\u6216\u8005\u5341\u516d\u8fdb\u5236\uff08",(0,l.kt)("inlineCode",{parentName:"p"},"\\xnn"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"\\unnnn")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"\\Unnnnnnnn"),"\uff09\u3002"),(0,l.kt)("p",null,"\u4e0e Go \u4e0d\u540c\uff0cPrometheus \u4e0d\u4f1a\u5bf9\u53cd\u5f15\u53f7\u5185\u7684\u6362\u884c\u7b26\u8fdb\u884c\u8f6c\u4e49\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"\"this is a string\"\n'these are unescaped: \\n \\\\ \\t'\n`these are not unescaped: \\n ' \" \\t`\n")),(0,l.kt)("h2",a({},{id:"\u6807\u91cf"}),"\u6807\u91cf"),(0,l.kt)("p",null,"\u6807\u91cf\u6d6e\u70b9\u503c\u53ef\u4ee5\u5b57\u9762\u4e0a\u5199\u6210 ",(0,l.kt)("inlineCode",{parentName:"p"},"[-](digits)[.(digits)]")," \u7684\u5f62\u5f0f\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"-2.43\n")),(0,l.kt)("h1",a({},{id:"\u65f6\u95f4\u5e8f\u5217\u8fc7\u6ee4\u5668"}),"\u65f6\u95f4\u5e8f\u5217\u8fc7\u6ee4\u5668"),(0,l.kt)("h2",a({},{id:"\u77ac\u65f6\u5411\u91cf\u8fc7\u6ee4\u5668"}),"\u77ac\u65f6\u5411\u91cf\u8fc7\u6ee4\u5668"),(0,l.kt)("p",null,"\u77ac\u65f6\u5411\u91cf\u8fc7\u6ee4\u5668\u5141\u8bb8\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u6233\u5185\u9009\u62e9\u4e00\u7ec4\u65f6\u95f4\u5e8f\u5217\u548c\u6bcf\u4e2a\u65f6\u95f4\u5e8f\u5217\u7684\u5355\u4e2a\u6837\u672c\u503c\u3002\u5728\u6700\u7b80\u5355\u7684\u5f62\u5f0f\u4e2d\uff0c\u8fd1\u6307\u5b9a\u6307\u6807\uff08metric\uff09\u540d\u79f0\u3002\u8fd9\u5c06\u751f\u6210\u5305\u542b\u6b64\u6307\u6807\u540d\u79f0\u7684\u6240\u6709\u65f6\u95f4\u5e8f\u5217\u7684\u5143\u7d20\u7684\u77ac\u65f6\u5411\u91cf\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff1a\u9009\u62e9\u6307\u6807\u540d\u79f0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"http_requests_total")," \u7684\u6240\u6709\u65f6\u95f4\u5e8f\u5217\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"http_requests_total\n")),(0,l.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u5411\u82b1\u62ec\u53f7\uff08",(0,l.kt)("inlineCode",{parentName:"p"},"{}"),"\uff09\u91cc\u9644\u52a0\u4e00\u7ec4\u6807\u7b7e\u6765\u8fdb\u4e00\u6b65\u8fc7\u6ee4\u65f6\u95f4\u5e8f\u5217\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff1a\u9009\u62e9\u6307\u6807\u540d\u79f0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"http_requests_total"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"job")," \u6807\u7b7e\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"prometheus"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"group")," \u6807\u7b7e\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"canary")," \u7684\u65f6\u95f4\u5e8f\u5217\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'http_requests_total{job="prometheus",group="canary"}\n')),(0,l.kt)("p",null,"PromQL \u8fd8\u652f\u6301\u7528\u6237\u6839\u636e\u65f6\u95f4\u5e8f\u5217\u7684\u6807\u7b7e\u5339\u914d\u6a21\u5f0f\u6765\u5bf9\u65f6\u95f4\u5e8f\u5217\u8fdb\u884c\u8fc7\u6ee4\uff0c\u76ee\u524d\u4e3b\u8981\u652f\u6301\u4e24\u79cd\u5339\u914d\u6a21\u5f0f\uff1a\u5b8c\u5168\u5339\u914d\u548c\u6b63\u5219\u5339\u914d\u3002\u603b\u5171\u6709\u4ee5\u4e0b\u51e0\u79cd\u6807\u7b7e\u5339\u914d\u8fd0\u7b97\u7b26\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"=")," : \u9009\u62e9\u4e0e\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u5b8c\u5168\u76f8\u540c\u7684\u6807\u7b7e\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"!=")," : \u9009\u62e9\u4e0e\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u4e0d\u76f8\u540c\u7684\u6807\u7b7e\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"=~")," : \u9009\u62e9\u6b63\u5219\u8868\u8fbe\u5f0f\u4e0e\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\uff08\u6216\u5b50\u5b57\u7b26\u4e32\uff09\u76f8\u5339\u914d\u7684\u6807\u7b7e\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"!~")," : \u9009\u62e9\u6b63\u5219\u8868\u8fbe\u5f0f\u4e0e\u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\uff08\u6216\u5b50\u5b57\u7b26\u4e32\uff09\u4e0d\u5339\u914d\u7684\u6807\u7b7e\u3002")),(0,l.kt)("p",null,"\u4f8b\u5982\uff1a\u9009\u62e9\u6307\u6807\u540d\u79f0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"http_requests_total"),"\uff0c\u73af\u5883\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"staging"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"testing")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"development"),"\uff0cHTTP \u65b9\u6cd5\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"GET")," \u7684\u65f6\u95f4\u5e8f\u5217\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'http_requests_total{environment=~"staging|testing|development",method!="GET"}\n')),(0,l.kt)("p",null,"\u6ca1\u6709\u6307\u5b9a\u6807\u7b7e\u7684\u6807\u7b7e\u8fc7\u6ee4\u5668\u4f1a\u9009\u62e9\u8be5\u6307\u6807\u540d\u79f0\u7684\u6240\u6709\u65f6\u95f4\u5e8f\u5217\u3002"),(0,l.kt)("p",null,"\u6240\u6709\u7684 PromQL \u8868\u8fbe\u5f0f\u5fc5\u987b\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u6307\u6807\u540d\u79f0\uff0c\u6216\u8005\u4e00\u4e2a\u4e0d\u4f1a\u5339\u914d\u5230\u7a7a\u5b57\u7b26\u4e32\u7684\u6807\u7b7e\u8fc7\u6ee4\u5668\u3002"),(0,l.kt)("p",null,"\u4ee5\u4e0b\u8868\u8fbe\u5f0f\u662f\u975e\u6cd5\u7684\uff08\u56e0\u4e3a\u4f1a\u5339\u914d\u5230\u7a7a\u5b57\u7b26\u4e32\uff09\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'{job=~".*"} # \u975e\u6cd5\uff01\n')),(0,l.kt)("p",null,"\u4ee5\u4e0b\u8868\u8fbe\u5f0f\u662f\u5408\u6cd5\u7684\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'{job=~".+"}              # \u5408\u6cd5\uff01\n{job=~".*",method="get"} # \u5408\u6cd5\uff01\n')),(0,l.kt)("p",null,"\u9664\u4e86\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"<metric name>{label=value}")," \u7684\u5f62\u5f0f\u4ee5\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5185\u7f6e\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"__name__")," \u6807\u7b7e\u6765\u6307\u5b9a\u76d1\u63a7\u6307\u6807\u540d\u79f0\u3002\u4f8b\u5982\uff1a\u8868\u8fbe\u5f0f ",(0,l.kt)("inlineCode",{parentName:"p"},"http_requests_total")," \u7b49\u6548\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},'{__name__="http_requests_total"}'),"\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9664 ",(0,l.kt)("inlineCode",{parentName:"p"},"=")," \u4e4b\u5916\u7684\u8fc7\u6ee4\u5668\uff08",(0,l.kt)("inlineCode",{parentName:"p"},"="),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"=~"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"~"),"\uff09\u3002\u4ee5\u4e0b\u8868\u8fbe\u5f0f\u9009\u62e9\u6307\u6807\u540d\u79f0\u4ee5 ",(0,l.kt)("inlineCode",{parentName:"p"},"job:")," \u5f00\u5934\u7684\u6240\u6709\u6307\u6807\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'{__name__=~"job:.*"}\n')),(0,l.kt)("h2",a({},{id:"\u533a\u95f4\u5411\u91cf\u8fc7\u6ee4\u5668"}),"\u533a\u95f4\u5411\u91cf\u8fc7\u6ee4\u5668"),(0,l.kt)("p",null,"\u533a\u95f4\u5411\u91cf\u4e0e\u77ac\u65f6\u5411\u91cf\u7684\u5de5\u4f5c\u65b9\u5f0f\u7c7b\u4f3c\uff0c\u552f\u4e00\u7684\u5dee\u5f02\u5728\u4e8e\u5728\u533a\u95f4\u5411\u91cf\u8868\u8fbe\u5f0f\u4e2d\u6211\u4eec\u9700\u8981\u5b9a\u4e49\u65f6\u95f4\u9009\u62e9\u7684\u8303\u56f4\uff0c\u65f6\u95f4\u8303\u56f4\u901a\u8fc7\u65f6\u95f4\u8303\u56f4\u9009\u62e9\u5668 ",(0,l.kt)("inlineCode",{parentName:"p"},"[]")," \u8fdb\u884c\u5b9a\u4e49\uff0c\u4ee5\u6307\u5b9a\u5e94\u4e3a\u6bcf\u4e2a\u8fd4\u56de\u7684\u533a\u95f4\u5411\u91cf\u6837\u672c\u503c\u4e2d\u63d0\u53d6\u591a\u957f\u7684\u65f6\u95f4\u8303\u56f4\u3002"),(0,l.kt)("p",null,"\u65f6\u95f4\u8303\u56f4\u901a\u8fc7\u6570\u5b57\u6765\u8868\u793a\uff0c\u5355\u4f4d\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5176\u4e2d\u4e4b\u4e00\u7684\u65f6\u95f4\u5355\u4f4d\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"s")," - \u79d2"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"m")," - \u5206\u949f"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"h")," - \u5c0f\u65f6"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"d")," - \u5929"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"w")," - \u5468"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"y")," - \u5e74")),(0,l.kt)("p",null,"\u4f8b\u5982\uff1a\u9009\u62e9\u5728\u8fc7\u53bb 5 \u5206\u949f\u5185\u6307\u6807\u540d\u79f0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"http_requests_total"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"job")," \u6807\u7b7e\u503c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"prometheus")," \u7684\u6240\u6709\u65f6\u95f4\u5e8f\u5217\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'http_requests_total{job="prometheus"}[5m]\n')),(0,l.kt)("h2",a({},{id:"\u65f6\u95f4\u4f4d\u79fb\u64cd\u4f5c"}),"\u65f6\u95f4\u4f4d\u79fb\u64cd\u4f5c"),(0,l.kt)("p",null,"\u5728\u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\u6216\u8005\u533a\u95f4\u5411\u91cf\u8868\u8fbe\u5f0f\u4e2d\uff0c\u90fd\u662f\u4ee5\u5f53\u524d\u65f6\u95f4\u4e3a\u57fa\u51c6\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"http_request_total{} # \u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\uff0c\u9009\u62e9\u5f53\u524d\u6700\u65b0\u7684\u6570\u636e\nhttp_request_total{}[5m] # \u533a\u95f4\u5411\u91cf\u8868\u8fbe\u5f0f\uff0c\u9009\u62e9\u4ee5\u5f53\u524d\u65f6\u95f4\u4e3a\u57fa\u51c6\uff0c5\u5206\u949f\u5185\u7684\u6570\u636e\n")),(0,l.kt)("p",null,"\u800c\u5982\u679c\u6211\u4eec\u60f3\u67e5\u8be2\uff0c5 \u5206\u949f\u524d\u7684\u77ac\u65f6\u6837\u672c\u6570\u636e\uff0c\u6216\u6628\u5929\u4e00\u5929\u7684\u533a\u95f4\u5185\u7684\u6837\u672c\u6570\u636e\u5462? \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u4f4d\u79fb\u64cd\u4f5c\uff0c\u4f4d\u79fb\u64cd\u4f5c\u7684\u5173\u952e\u5b57\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"offset"),"\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff0c\u4ee5\u4e0b\u8868\u8fbe\u5f0f\u8fd4\u56de\u76f8\u5bf9\u4e8e\u5f53\u524d\u67e5\u8be2\u65f6\u95f4\u8fc7\u53bb 5 \u5206\u949f\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"http_requests_total")," \u503c\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"http_requests_total offset 5m\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a"),(0,l.kt)("inlineCode",{parentName:"p"},"offset")," \u5173\u952e\u5b57\u9700\u8981\u7d27\u8ddf\u5728\u9009\u62e9\u5668\uff08",(0,l.kt)("inlineCode",{parentName:"p"},"{}"),"\uff09\u540e\u9762\u3002\u4ee5\u4e0b\u8868\u8fbe\u5f0f\u662f\u6b63\u786e\u7684\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'sum(http_requests_total{method="GET"} offset 5m) // GOOD.\n')),(0,l.kt)("p",null,"\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\u662f\u4e0d\u5408\u6cd5\u7684\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'sum(http_requests_total{method="GET"}) offset 5m // INVALID.\n')),(0,l.kt)("p",null,"\u8be5\u64cd\u4f5c\u540c\u6837\u9002\u7528\u4e8e\u533a\u95f4\u5411\u91cf\u3002\u4ee5\u4e0b\u8868\u8fbe\u5f0f\u8fd4\u56de\u6307\u6807 ",(0,l.kt)("inlineCode",{parentName:"p"},"http_requests_total")," \u4e00\u5468\u524d\u7684 5 \u5206\u949f\u4e4b\u5185\u7684 HTTP \u8bf7\u6c42\u91cf\u7684\u589e\u957f\u7387:"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"rate(http_requests_total[5m] offset 1w)\n")),(0,l.kt)("h1",a({},{id:"\u64cd\u4f5c\u7b26"}),"\u64cd\u4f5c\u7b26"),(0,l.kt)("p",null,"\u4f7f\u7528PromQL\u9664\u4e86\u80fd\u591f\u65b9\u4fbf\u7684\u6309\u7167\u67e5\u8be2\u548c\u8fc7\u6ee4\u65f6\u95f4\u5e8f\u5217\u4ee5\u5916\uff0cPromQL\u8fd8\u652f\u6301\u4e30\u5bcc\u7684\u64cd\u4f5c\u7b26\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u64cd\u4f5c\u7b26\u5bf9\u8fdb\u4e00\u6b65\u7684\u5bf9\u4e8b\u4ef6\u5e8f\u5217\u8fdb\u884c\u4e8c\u6b21\u52a0\u5de5\u3002\u8fd9\u4e9b\u64cd\u4f5c\u7b26\u5305\u62ec\uff1a\u6570\u5b66\u8fd0\u7b97\u7b26\uff0c\u903b\u8f91\u8fd0\u7b97\u7b26\uff0c\u5e03\u5c14\u8fd0\u7b97\u7b26\u7b49\u7b49\u3002"),(0,l.kt)("h2",a({},{id:"\u4e8c\u5143\u8fd0\u7b97\u7b26"}),"\u4e8c\u5143\u8fd0\u7b97\u7b26"),(0,l.kt)("p",null,"Prometheus \u7684\u67e5\u8be2\u8bed\u8a00\u652f\u6301\u57fa\u672c\u7684\u903b\u8f91\u8fd0\u7b97\u548c\u7b97\u672f\u8fd0\u7b97\u3002\u5bf9\u4e8e\u4e24\u4e2a\u77ac\u65f6\u5411\u91cf, \u5339\u914d\u884c\u4e3a\u53ef\u4ee5\u88ab\u6539\u53d8\u3002"),(0,l.kt)("h3",a({},{id:"\u7b97\u672f\u4e8c\u5143\u8fd0\u7b97\u7b26"}),"\u7b97\u672f\u4e8c\u5143\u8fd0\u7b97\u7b26"),(0,l.kt)("p",null,"\u5728 Prometheus \u7cfb\u7edf\u4e2d\u652f\u6301\u4e0b\u9762\u7684\u4e8c\u5143\u7b97\u672f\u8fd0\u7b97\u7b26\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"+")," \u52a0\u6cd5"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-")," \u51cf\u6cd5"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"*")," \u4e58\u6cd5"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"/")," \u9664\u6cd5"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"%")," \u6a21"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"^")," \u5e42\u7b49")),(0,l.kt)("p",null,"\u4e8c\u5143\u8fd0\u7b97\u64cd\u4f5c\u7b26\u652f\u6301 ",(0,l.kt)("inlineCode",{parentName:"p"},"scalar/scalar(\u6807\u91cf/\u6807\u91cf)"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"vector/scalar(\u5411\u91cf/\u6807\u91cf)"),"\u3001\u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"vector/vector(\u5411\u91cf/\u5411\u91cf)")," \u4e4b\u95f4\u7684\u64cd\u4f5c\u3002"),(0,l.kt)("p",null,"\u5728\u4e24\u4e2a\u6807\u91cf\u4e4b\u95f4\u8fdb\u884c\u6570\u5b66\u8fd0\u7b97\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u4e5f\u662f\u6807\u91cf\u3002"),(0,l.kt)("p",null,"\u5728\u5411\u91cf\u548c\u6807\u91cf\u4e4b\u95f4\uff0c\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u4f1a\u4f5c\u7528\u4e8e\u8fd9\u4e2a\u5411\u91cf\u7684\u6bcf\u4e2a\u6837\u672c\u503c\u4e0a\u3002\u4f8b\u5982\uff1a\u5982\u679c\u4e00\u4e2a\u65f6\u95f4\u5e8f\u5217\u77ac\u65f6\u5411\u91cf\u9664\u4ee5 2\uff0c\u64cd\u4f5c\u7ed3\u679c\u4e5f\u662f\u4e00\u4e2a\u65b0\u7684\u77ac\u65f6\u5411\u91cf\uff0c\u4e14\u5ea6\u91cf\u6307\u6807\u540d\u79f0\u4e0d\u53d8, \u5b83\u662f\u539f\u5ea6\u91cf\u6307\u6807\u77ac\u65f6\u5411\u91cf\u7684\u6bcf\u4e2a\u6837\u672c\u503c\u9664\u4ee5 2\u3002"),(0,l.kt)("p",null,"\u5982\u679c\u662f\u77ac\u65f6\u5411\u91cf\u4e0e\u77ac\u65f6\u5411\u91cf\u4e4b\u95f4\u8fdb\u884c\u6570\u5b66\u8fd0\u7b97\u65f6\uff0c\u8fc7\u7a0b\u4f1a\u76f8\u5bf9\u590d\u6742\u4e00\u70b9\uff0c\u8fd0\u7b97\u7b26\u4f1a\u4f9d\u6b21\u627e\u5230\u4e0e\u5de6\u8fb9\u5411\u91cf\u5143\u7d20\u5339\u914d\uff08\u6807\u7b7e\u5b8c\u5168\u4e00\u81f4\uff09\u7684\u53f3\u8fb9\u5411\u91cf\u5143\u7d20\u8fdb\u884c\u8fd0\u7b97\uff0c\u5982\u679c\u6ca1\u627e\u5230\u5339\u914d\u5143\u7d20\uff0c\u5219\u76f4\u63a5\u4e22\u5f03\u3002\u540c\u65f6\u65b0\u7684\u65f6\u95f4\u5e8f\u5217\u5c06\u4e0d\u4f1a\u5305\u542b\u6307\u6807\u540d\u79f0\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u60f3\u6839\u636e ",(0,l.kt)("inlineCode",{parentName:"p"},"node_disk_bytes_written")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"node_disk_bytes_read")," \u83b7\u53d6\u4e3b\u673a\u78c1\u76d8IO\u7684\u603b\u91cf\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u8868\u8fbe\u5f0f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"node_disk_bytes_written + node_disk_bytes_read\n")),(0,l.kt)("p",null,"\u8be5\u8868\u8fbe\u5f0f\u8fd4\u56de\u7ed3\u679c\u7684\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'{device="sda",instance="localhost:9100",job="node_exporter"}=>1634967552@1518146427.807 + 864551424@1518146427.807\n{device="sdb",instance="localhost:9100",job="node_exporter"}=>0@1518146427.807 + 1744384@1518146427.807\n')),(0,l.kt)("h3",a({},{id:"\u5e03\u5c14\u8fd0\u7b97\u7b26"}),"\u5e03\u5c14\u8fd0\u7b97\u7b26"),(0,l.kt)("p",null,"\u76ee\u524d\uff0cPrometheus \u652f\u6301\u4ee5\u4e0b\u5e03\u5c14\u8fd0\u7b97\u7b26\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"==")," (\u76f8\u7b49)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"!=")," (\u4e0d\u76f8\u7b49)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},">")," (\u5927\u4e8e)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"<")," (\u5c0f\u4e8e)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},">=")," (\u5927\u4e8e\u7b49\u4e8e)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"<=")," (\u5c0f\u4e8e\u7b49\u4e8e)")),(0,l.kt)("p",null,"\u5e03\u5c14\u8fd0\u7b97\u7b26\u88ab\u5e94\u7528\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"scalar/scalar\uff08\u6807\u91cf/\u6807\u91cf\uff09"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"vector/scalar\uff08\u5411\u91cf/\u6807\u91cf\uff09"),"\uff0c\u548c",(0,l.kt)("inlineCode",{parentName:"p"},"vector/vector\uff08\u5411\u91cf/\u5411\u91cf\uff09"),"\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5e03\u5c14\u8fd0\u7b97\u7b26\u53ea\u4f1a\u6839\u636e\u65f6\u95f4\u5e8f\u5217\u4e2d\u6837\u672c\u7684\u503c\uff0c\u5bf9\u65f6\u95f4\u5e8f\u5217\u8fdb\u884c\u8fc7\u6ee4\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5728\u8fd0\u7b97\u7b26\u540e\u9762\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"bool")," \u4fee\u9970\u7b26\u6765\u6539\u53d8\u5e03\u5c14\u8fd0\u7b97\u7684\u9ed8\u8ba4\u884c\u4e3a\u3002\u4f7f\u7528 bool \u4fee\u6539\u7b26\u540e\uff0c\u5e03\u5c14\u8fd0\u7b97\u4e0d\u4f1a\u5bf9\u65f6\u95f4\u5e8f\u5217\u8fdb\u884c\u8fc7\u6ee4\uff0c\u800c\u662f\u76f4\u63a5\u4f9d\u6b21\u77ac\u65f6\u5411\u91cf\u4e2d\u7684\u5404\u4e2a\u6837\u672c\u6570\u636e\u4e0e\u6807\u91cf\u7684\u6bd4\u8f83\u7ed3\u679c ",(0,l.kt)("inlineCode",{parentName:"p"},"0")," \u6216\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"1"),"\u3002"),(0,l.kt)("p",null,"\u5728\u4e24\u4e2a\u6807\u91cf\u4e4b\u95f4\u8fdb\u884c\u5e03\u5c14\u8fd0\u7b97\uff0c\u5fc5\u987b\u63d0\u4f9b bool \u4fee\u9970\u7b26\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u4e5f\u662f\u6807\u91cf\uff0c\u5373 ",(0,l.kt)("inlineCode",{parentName:"p"},"0"),"\uff08",(0,l.kt)("inlineCode",{parentName:"p"},"false"),"\uff09\u6216 ",(0,l.kt)("inlineCode",{parentName:"p"},"1"),"\uff08",(0,l.kt)("inlineCode",{parentName:"p"},"true"),"\uff09\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"2 > bool 1 # \u7ed3\u679c\u4e3a 1\n")),(0,l.kt)("p",null,"\u77ac\u65f6\u5411\u91cf\u548c\u6807\u91cf\u4e4b\u95f4\u7684\u5e03\u5c14\u8fd0\u7b97\uff0c\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u4f1a\u5e94\u7528\u5230\u67d0\u4e2a\u5f53\u524d\u65f6\u523b\u7684\u6bcf\u4e2a\u65f6\u5e8f\u6570\u636e\u4e0a\uff0c\u5982\u679c\u4e00\u4e2a\u65f6\u5e8f\u6570\u636e\u7684\u6837\u672c\u503c\u4e0e\u8fd9\u4e2a\u6807\u91cf\u6bd4\u8f83\u7684\u7ed3\u679c\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"false"),"\uff0c\u5219\u8fd9\u4e2a\u65f6\u5e8f\u6570\u636e\u88ab\u4e22\u5f03\u6389\uff0c\u5982\u679c\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"true"),", \u5219\u8fd9\u4e2a\u65f6\u5e8f\u6570\u636e\u88ab\u4fdd\u7559\u5728\u7ed3\u679c\u4e2d\u3002\u5982\u679c\u63d0\u4f9b\u4e86 bool \u4fee\u9970\u7b26\uff0c\u90a3\u4e48\u6bd4\u8f83\u7ed3\u679c\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"0")," \u7684\u65f6\u5e8f\u6570\u636e\u88ab\u4e22\u5f03\u6389\uff0c\u800c\u6bd4\u8f83\u7ed3\u679c\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"1")," \u7684\u65f6\u5e8f\u6570\u636e\u88ab\u4fdd\u7559\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"http_requests_total > 100 # \u7ed3\u679c\u4e3a true \u6216 false\nhttp_requests_total > bool 100 # \u7ed3\u679c\u4e3a 1 \u6216 0\n")),(0,l.kt)("p",null,"\u77ac\u65f6\u5411\u91cf\u4e0e\u77ac\u65f6\u5411\u91cf\u76f4\u63a5\u8fdb\u884c\u5e03\u5c14\u8fd0\u7b97\u65f6\uff0c\u540c\u6837\u9075\u5faa\u9ed8\u8ba4\u7684\u5339\u914d\u6a21\u5f0f\uff1a\u4f9d\u6b21\u627e\u5230\u4e0e\u5de6\u8fb9\u5411\u91cf\u5143\u7d20\u5339\u914d\uff08\u6807\u7b7e\u5b8c\u5168\u4e00\u81f4\uff09\u7684\u53f3\u8fb9\u5411\u91cf\u5143\u7d20\u8fdb\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u5982\u679c\u6ca1\u627e\u5230\u5339\u914d\u5143\u7d20\uff0c\u6216\u8005\u8ba1\u7b97\u7ed3\u679c\u4e3a false\uff0c\u5219\u76f4\u63a5\u4e22\u5f03\u3002\u5982\u679c\u5339\u914d\u4e0a\u4e86\uff0c\u5219\u5c06\u5de6\u8fb9\u5411\u91cf\u7684\u5ea6\u91cf\u6307\u6807\u548c\u6807\u7b7e\u7684\u6837\u672c\u6570\u636e\u5199\u5165\u77ac\u65f6\u5411\u91cf\u3002\u5982\u679c\u63d0\u4f9b\u4e86 bool \u4fee\u9970\u7b26\uff0c\u90a3\u4e48\u6bd4\u8f83\u7ed3\u679c\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"0")," \u7684\u65f6\u5e8f\u6570\u636e\u88ab\u4e22\u5f03\u6389\uff0c\u800c\u6bd4\u8f83\u7ed3\u679c\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"1")," \u7684\u65f6\u5e8f\u6570\u636e\uff08\u53ea\u4fdd\u7559\u5de6\u8fb9\u5411\u91cf\uff09\u88ab\u4fdd\u7559\u3002"),(0,l.kt)("h3",a({},{id:"\u96c6\u5408\u8fd0\u7b97\u7b26"}),"\u96c6\u5408\u8fd0\u7b97\u7b26"),(0,l.kt)("p",null,"\u4f7f\u7528\u77ac\u65f6\u5411\u91cf\u8868\u8fbe\u5f0f\u80fd\u591f\u83b7\u53d6\u5230\u4e00\u4e2a\u5305\u542b\u591a\u4e2a\u65f6\u95f4\u5e8f\u5217\u7684\u96c6\u5408\uff0c\u6211\u4eec\u79f0\u4e3a\u77ac\u65f6\u5411\u91cf\u3002 \u901a\u8fc7\u96c6\u5408\u8fd0\u7b97\uff0c\u53ef\u4ee5\u5728\u4e24\u4e2a\u77ac\u65f6\u5411\u91cf\u4e0e\u77ac\u65f6\u5411\u91cf\u4e4b\u95f4\u8fdb\u884c\u76f8\u5e94\u7684\u96c6\u5408\u64cd\u4f5c\u3002\u76ee\u524d\uff0cPrometheus \u652f\u6301\u4ee5\u4e0b\u96c6\u5408\u8fd0\u7b97\u7b26\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"and")," (\u5e76\u4e14)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"or")," (\u6216\u8005)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"unless")," (\u6392\u9664)")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"vector1 and vector2")," \u4f1a\u4ea7\u751f\u4e00\u4e2a\u7531 ",(0,l.kt)("inlineCode",{parentName:"p"},"vector1")," \u7684\u5143\u7d20\u7ec4\u6210\u7684\u65b0\u7684\u5411\u91cf\u3002\u8be5\u5411\u91cf\u5305\u542b vector1 \u4e2d\u5b8c\u5168\u5339\u914d ",(0,l.kt)("inlineCode",{parentName:"p"},"vector2")," \u4e2d\u7684\u5143\u7d20\u7ec4\u6210\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"vector1 or vector2")," \u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u5411\u91cf\uff0c\u8be5\u5411\u91cf\u5305\u542b ",(0,l.kt)("inlineCode",{parentName:"p"},"vector1")," \u4e2d\u6240\u6709\u7684\u6837\u672c\u6570\u636e\uff0c\u4ee5\u53ca ",(0,l.kt)("inlineCode",{parentName:"p"},"vector2")," \u4e2d\u6ca1\u6709\u4e0e ",(0,l.kt)("inlineCode",{parentName:"p"},"vector1")," \u5339\u914d\u5230\u7684\u6837\u672c\u6570\u636e\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"vector1 unless vector2")," \u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u5411\u91cf\uff0c\u65b0\u5411\u91cf\u4e2d\u7684\u5143\u7d20\u7531 ",(0,l.kt)("inlineCode",{parentName:"p"},"vector1")," \u4e2d\u6ca1\u6709\u4e0e ",(0,l.kt)("inlineCode",{parentName:"p"},"vector2")," \u5339\u914d\u7684\u5143\u7d20\u7ec4\u6210\u3002"),(0,l.kt)("h2",a({},{id:"\u5339\u914d\u6a21\u5f0f"}),"\u5339\u914d\u6a21\u5f0f"),(0,l.kt)("p",null,"\u5411\u91cf\u4e0e\u5411\u91cf\u4e4b\u95f4\u8fdb\u884c\u8fd0\u7b97\u64cd\u4f5c\u65f6\u4f1a\u57fa\u4e8e\u9ed8\u8ba4\u7684\u5339\u914d\u89c4\u5219\uff1a\u4f9d\u6b21\u627e\u5230\u4e0e\u5de6\u8fb9\u5411\u91cf\u5143\u7d20\u5339\u914d\uff08\u6807\u7b7e\u5b8c\u5168\u4e00\u81f4\uff09\u7684\u53f3\u8fb9\u5411\u91cf\u5143\u7d20\u8fdb\u884c\u8fd0\u7b97\uff0c\u5982\u679c\u6ca1\u627e\u5230\u5339\u914d\u5143\u7d20\uff0c\u5219\u76f4\u63a5\u4e22\u5f03\u3002"),(0,l.kt)("p",null,"\u63a5\u4e0b\u6765\u5c06\u4ecb\u7ecd\u5728 PromQL \u4e2d\u6709\u4e24\u79cd\u5178\u578b\u7684\u5339\u914d\u6a21\u5f0f\uff1a\u4e00\u5bf9\u4e00\uff08one-to-one\uff09,\u591a\u5bf9\u4e00\uff08many-to-one\uff09\u6216\u4e00\u5bf9\u591a\uff08one-to-many\uff09\u3002"),(0,l.kt)("h3",a({},{id:"\u4e00\u5bf9\u4e00\u5339\u914d"}),"\u4e00\u5bf9\u4e00\u5339\u914d"),(0,l.kt)("p",null,"\u4e00\u5bf9\u4e00\u5339\u914d\u6a21\u5f0f\u4f1a\u4ece\u64cd\u4f5c\u7b26\u4e24\u8fb9\u8868\u8fbe\u5f0f\u83b7\u53d6\u7684\u77ac\u65f6\u5411\u91cf\u4f9d\u6b21\u6bd4\u8f83\u5e76\u627e\u5230\u552f\u4e00\u5339\u914d(\u6807\u7b7e\u5b8c\u5168\u4e00\u81f4)\u7684\u6837\u672c\u503c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u8868\u8fbe\u5f0f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"vector1 <operator> vector2\n")),(0,l.kt)("p",null,"\u5728\u64cd\u4f5c\u7b26\u4e24\u8fb9\u8868\u8fbe\u5f0f\u6807\u7b7e\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"on(label list)")," \u6216\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"ignoring(label list\uff09"),"\u6765\u4fee\u6539\u4fbf\u7b7e\u7684\u5339\u914d\u884c\u4e3a\u3002\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"ignoreing")," \u53ef\u4ee5\u5728\u5339\u914d\u65f6\u5ffd\u7565\u67d0\u4e9b\u4fbf\u7b7e\u3002\u800c ",(0,l.kt)("inlineCode",{parentName:"p"},"on")," \u5219\u7528\u4e8e\u5c06\u5339\u914d\u884c\u4e3a\u9650\u5b9a\u5728\u67d0\u4e9b\u4fbf\u7b7e\u4e4b\u5185\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"<vector expr> <bin-op> ignoring(<label list>) <vector expr>\n<vector expr> <bin-op> on(<label list>) <vector expr>\n")),(0,l.kt)("p",null,"\u4f8b\u5982\u5f53\u5b58\u5728\u6837\u672c\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'method_code:http_errors:rate5m{method="get", code="500"}  24\nmethod_code:http_errors:rate5m{method="get", code="404"}  30\nmethod_code:http_errors:rate5m{method="put", code="501"}  3\nmethod_code:http_errors:rate5m{method="post", code="500"} 6\nmethod_code:http_errors:rate5m{method="post", code="404"} 21\n\nmethod:http_requests:rate5m{method="get"}  600\nmethod:http_requests:rate5m{method="del"}  34\nmethod:http_requests:rate5m{method="post"} 120\n')),(0,l.kt)("p",null,"\u4f7f\u7528 PromQL \u8868\u8fbe\u5f0f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'method_code:http_errors:rate5m{code="500"} / ignoring(code) method:http_requests:rate5m\n')),(0,l.kt)("p",null,"\u8be5\u8868\u8fbe\u5f0f\u4f1a\u8fd4\u56de\u5728\u8fc7\u53bb 5 \u5206\u949f\u5185\uff0cHTTP \u8bf7\u6c42\u72b6\u6001\u7801\u4e3a 500 \u7684\u5728\u6240\u6709\u8bf7\u6c42\u4e2d\u7684\u6bd4\u4f8b\u3002\u5982\u679c\u6ca1\u6709\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"ignoring(code)"),"\uff0c\u64cd\u4f5c\u7b26\u4e24\u8fb9\u8868\u8fbe\u5f0f\u8fd4\u56de\u7684\u77ac\u65f6\u5411\u91cf\u4e2d\u5c06\u627e\u4e0d\u5230\u4efb\u4f55\u4e00\u4e2a\u6807\u7b7e\u5b8c\u5168\u76f8\u540c\u7684\u5339\u914d\u9879\u3002"),(0,l.kt)("p",null,"\u56e0\u6b64\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'{method="get"}  0.04            //  24 / 600\n{method="post"} 0.05            //   6 / 120\n')),(0,l.kt)("p",null,"\u540c\u65f6\u7531\u4e8e method \u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"put")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"del")," \u7684\u6837\u672c\u627e\u4e0d\u5230\u5339\u914d\u9879\uff0c\u56e0\u6b64\u4e0d\u4f1a\u51fa\u73b0\u5728\u7ed3\u679c\u5f53\u4e2d\u3002"),(0,l.kt)("h3",a({},{id:"\u591a\u5bf9\u4e00\u548c\u4e00\u5bf9\u591a"}),"\u591a\u5bf9\u4e00\u548c\u4e00\u5bf9\u591a"),(0,l.kt)("p",null,'\u591a\u5bf9\u4e00\u548c\u4e00\u5bf9\u591a\u4e24\u79cd\u5339\u914d\u6a21\u5f0f\u6307\u7684\u662f\u201c\u4e00\u201d\u4fa7\u7684\u6bcf\u4e00\u4e2a\u5411\u91cf\u5143\u7d20\u53ef\u4ee5\u4e0e"\u591a"\u4fa7\u7684\u591a\u4e2a\u5143\u7d20\u5339\u914d\u7684\u60c5\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5fc5\u987b\u4f7f\u7528 group \u4fee\u9970\u7b26\uff1a',(0,l.kt)("inlineCode",{parentName:"p"},"group_left")," \u6216\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"group_right")," \u6765\u786e\u5b9a\u54ea\u4e00\u4e2a\u5411\u91cf\u5177\u6709\u66f4\u9ad8\u7684\u57fa\u6570\uff08\u5145\u5f53\u201c\u591a\u201d\u7684\u89d2\u8272\uff09\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"<vector expr> <bin-op> ignoring(<label list>) group_left(<label list>) <vector expr>\n<vector expr> <bin-op> ignoring(<label list>) group_right(<label list>) <vector expr>\n<vector expr> <bin-op> on(<label list>) group_left(<label list>) <vector expr>\n<vector expr> <bin-op> on(<label list>) group_right(<label list>) <vector expr>\n")),(0,l.kt)("p",null,"\u591a\u5bf9\u4e00\u548c\u4e00\u5bf9\u591a\u4e24\u79cd\u6a21\u5f0f\u4e00\u5b9a\u662f\u51fa\u73b0\u5728\u64cd\u4f5c\u7b26\u4e24\u4fa7\u8868\u8fbe\u5f0f\u8fd4\u56de\u7684\u5411\u91cf\u6807\u7b7e\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5\u3002\u56e0\u6b64\u9700\u8981\u4f7f\u7528 ignoring \u548c on \u4fee\u9970\u7b26\u6765\u6392\u9664\u6216\u8005\u9650\u5b9a\u5339\u914d\u7684\u6807\u7b7e\u5217\u8868\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff0c\u4f7f\u7528\u8868\u8fbe\u5f0f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"method_code:http_errors:rate5m / ignoring(code) group_left method:http_requests:rate5m\n")),(0,l.kt)("p",null,"\u8be5\u8868\u8fbe\u5f0f\u4e2d\uff0c\u5de6\u5411\u91cf ",(0,l.kt)("inlineCode",{parentName:"p"},"method_code:http_errors:rate5m")," \u5305\u542b\u4e24\u4e2a\u6807\u7b7e ",(0,l.kt)("inlineCode",{parentName:"p"},"method")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"code"),"\u3002\u800c\u53f3\u5411\u91cf ",(0,l.kt)("inlineCode",{parentName:"p"},"method:http_requests:rate5m")," \u4e2d\u53ea\u5305\u542b\u4e00\u4e2a\u6807\u7b7e ",(0,l.kt)("inlineCode",{parentName:"p"},"method"),"\uff0c\u56e0\u6b64\u5339\u914d\u65f6\u9700\u8981\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"ignoring")," \u9650\u5b9a\u5339\u914d\u7684\u6807\u7b7e\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"code"),"\u3002 \u5728\u9650\u5b9a\u5339\u914d\u6807\u7b7e\u540e\uff0c\u53f3\u5411\u91cf\u4e2d\u7684\u5143\u7d20\u53ef\u80fd\u5339\u914d\u5230\u591a\u4e2a\u5de6\u5411\u91cf\u4e2d\u7684\u5143\u7d20 \u56e0\u6b64\u8be5\u8868\u8fbe\u5f0f\u7684\u5339\u914d\u6a21\u5f0f\u4e3a\u591a\u5bf9\u4e00\uff0c\u9700\u8981\u4f7f\u7528 group \u4fee\u9970\u7b26 ",(0,l.kt)("inlineCode",{parentName:"p"},"group_left")," \u6307\u5b9a\u5de6\u5411\u91cf\u5177\u6709\u66f4\u597d\u7684\u57fa\u6570\u3002"),(0,l.kt)("p",null,"\u6700\u7ec8\u7684\u8fd0\u7b97\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'{method="get", code="500"}  0.04            //  24 / 600\n{method="get", code="404"}  0.05            //  30 / 600\n{method="post", code="500"} 0.05            //   6 / 120\n{method="post", code="404"} 0.175           //  21 / 120\n')),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},"\u26a0\ufe0f  \u63d0\u9192"),"\n",(0,l.kt)("inlineCode",{parentName:"p"},"group")," \u4fee\u9970\u7b26\u53ea\u80fd\u5728\u6bd4\u8f83\u548c\u6570\u5b66\u8fd0\u7b97\u7b26\u4e2d\u4f7f\u7528\u3002\u5728\u903b\u8f91\u8fd0\u7b97 ",(0,l.kt)("inlineCode",{parentName:"p"},"and"),"\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"unless")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"or")," \u64cd\u4f5c\u4e2d\u9ed8\u8ba4\u4e0e\u53f3\u5411\u91cf\u4e2d\u7684\u6240\u6709\u5143\u7d20\u8fdb\u884c\u5339\u914d\u3002")),(0,l.kt)("h2",a({},{id:"\u805a\u5408\u64cd\u4f5c"}),"\u805a\u5408\u64cd\u4f5c"),(0,l.kt)("p",null,"Prometheus \u8fd8\u63d0\u4f9b\u4e86\u4e0b\u5217\u5185\u7f6e\u7684\u805a\u5408\u64cd\u4f5c\u7b26\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u7b26\u4f5c\u7528\u57df\u77ac\u65f6\u5411\u91cf\u3002\u53ef\u4ee5\u5c06\u77ac\u65f6\u8868\u8fbe\u5f0f\u8fd4\u56de\u7684\u6837\u672c\u6570\u636e\u8fdb\u884c\u805a\u5408\uff0c\u5f62\u6210\u4e00\u4e2a\u5177\u6709\u8f83\u5c11\u6837\u672c\u503c\u7684\u65b0\u7684\u65f6\u95f4\u5e8f\u5217\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"sum")," (\u6c42\u548c)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"min")," (\u6700\u5c0f\u503c)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"max")," (\u6700\u5927\u503c)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"avg")," (\u5e73\u5747\u503c)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"stddev")," (\u6807\u51c6\u5dee)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"stdvar")," (\u6807\u51c6\u5dee\u5f02)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"count")," (\u8ba1\u6570)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"count_values")," (\u5bf9 value \u8fdb\u884c\u8ba1\u6570)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"bottomk")," (\u6837\u672c\u503c\u6700\u5c0f\u7684 k \u4e2a\u5143\u7d20)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"topk")," (\u6837\u672c\u503c\u6700\u5927\u7684k\u4e2a\u5143\u7d20)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"quantile")," (\u5206\u5e03\u7edf\u8ba1)")),(0,l.kt)("p",null,"\u8fd9\u4e9b\u64cd\u4f5c\u7b26\u88ab\u7528\u4e8e\u805a\u5408\u6240\u6709\u6807\u7b7e\u7ef4\u5ea6\uff0c\u6216\u8005\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"without")," \u6216\u8005 ",(0,l.kt)("inlineCode",{parentName:"p"},"by")," \u5b50\u8bed\u53e5\u6765\u4fdd\u7559\u4e0d\u540c\u7684\u7ef4\u5ea6\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"<aggr-op>([parameter,] <vector expression>) [without|by (<label list>)]\n")),(0,l.kt)("p",null,"\u5176\u4e2d\u53ea\u6709 ",(0,l.kt)("inlineCode",{parentName:"p"},"count_values"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"quantile"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"topk"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"bottomk")," \u652f\u6301\u53c2\u6570(parameter)\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"without")," \u7528\u4e8e\u4ece\u8ba1\u7b97\u7ed3\u679c\u4e2d\u79fb\u9664\u5217\u4e3e\u7684\u6807\u7b7e\uff0c\u800c\u4fdd\u7559\u5176\u5b83\u6807\u7b7e\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"by")," \u5219\u6b63\u597d\u76f8\u53cd\uff0c\u7ed3\u679c\u5411\u91cf\u4e2d\u53ea\u4fdd\u7559\u5217\u51fa\u7684\u6807\u7b7e\uff0c\u5176\u4f59\u6807\u7b7e\u5219\u79fb\u9664\u3002\u901a\u8fc7 without \u548c by \u53ef\u4ee5\u6309\u7167\u6837\u672c\u7684\u95ee\u9898\u5bf9\u6570\u636e\u8fdb\u884c\u805a\u5408\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,l.kt)("p",null,"\u5982\u679c\u6307\u6807 ",(0,l.kt)("inlineCode",{parentName:"p"},"http_requests_total")," \u7684\u65f6\u95f4\u5e8f\u5217\u7684\u6807\u7b7e\u96c6\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"application"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"instance"),", \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"group"),"\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u8ba1\u7b97\u6240\u6709 instance \u4e2d\u6bcf\u4e2a application \u548c group \u7684\u8bf7\u6c42\u603b\u91cf\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"sum(http_requests_total) without (instance)\n")),(0,l.kt)("p",null,"\u7b49\u4ef7\u4e8e\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{})," sum(http_requests_total) by (application, group)\n")),(0,l.kt)("p",null,"\u5982\u679c\u53ea\u9700\u8981\u8ba1\u7b97\u6574\u4e2a\u5e94\u7528\u7684 HTTP \u8bf7\u6c42\u603b\u91cf\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u8868\u8fbe\u5f0f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"sum(http_requests_total)\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"count_values")," \u7528\u4e8e\u65f6\u95f4\u5e8f\u5217\u4e2d\u6bcf\u4e00\u4e2a\u6837\u672c\u503c\u51fa\u73b0\u7684\u6b21\u6570\u3002count_values \u4f1a\u4e3a\u6bcf\u4e00\u4e2a\u552f\u4e00\u7684\u6837\u672c\u503c\u8f93\u51fa\u4e00\u4e2a\u65f6\u95f4\u5e8f\u5217\uff0c\u5e76\u4e14\u6bcf\u4e00\u4e2a\u65f6\u95f4\u5e8f\u5217\u5305\u542b\u4e00\u4e2a\u989d\u5916\u7684\u6807\u7b7e\u3002\u8fd9\u4e2a\u6807\u7b7e\u7684\u540d\u5b57\u7531\u805a\u5408\u53c2\u6570\u6307\u5b9a\uff0c\u540c\u65f6\u8fd9\u4e2a\u6807\u7b7e\u503c\u662f\u552f\u4e00\u7684\u6837\u672c\u503c\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\u8981\u8ba1\u7b97\u8fd0\u884c\u6bcf\u4e2a\u6784\u5efa\u7248\u672c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u6570\u91cf\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'count_values("version", build_version)\n')),(0,l.kt)("p",null,"\u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'{count="641"}   1\n{count="3226"}  2\n{count="644"}   4\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"topk")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"bottomk")," \u5219\u7528\u4e8e\u5bf9\u6837\u672c\u503c\u8fdb\u884c\u6392\u5e8f\uff0c\u8fd4\u56de\u5f53\u524d\u6837\u672c\u503c\u524d n \u4f4d\uff0c\u6216\u8005\u540e n \u4f4d\u7684\u65f6\u95f4\u5e8f\u5217\u3002"),(0,l.kt)("p",null,"\u83b7\u53d6 HTTP \u8bf7\u6c42\u6570\u524d 5 \u4f4d\u7684\u65f6\u5e8f\u6837\u672c\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528\u8868\u8fbe\u5f0f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"topk(5, http_requests_total)\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"quantile")," \u7528\u4e8e\u8ba1\u7b97\u5f53\u524d\u6837\u672c\u6570\u636e\u503c\u7684\u5206\u5e03\u60c5\u51b5 quantile(\u03c6, express) \uff0c\u5176\u4e2d ",(0,l.kt)("inlineCode",{parentName:"p"},"0 \u2264 \u03c6 \u2264 1"),"\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff0c\u5f53 \u03c6 \u4e3a 0.5 \u65f6\uff0c\u5373\u8868\u793a\u627e\u5230\u5f53\u524d\u6837\u672c\u6570\u636e\u4e2d\u7684\u4e2d\u4f4d\u6570\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"quantile(0.5, http_requests_total)\n")),(0,l.kt)("p",null,"\u8fd4\u56de\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"{}   656\n")),(0,l.kt)("h2",a({},{id:"\u4e8c\u5143\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7"}),"\u4e8c\u5143\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7"),(0,l.kt)("p",null,"\u5728 Prometheus \u7cfb\u7edf\u4e2d\uff0c\u4e8c\u5143\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u4ece\u9ad8\u5230\u4f4e\u7684\u987a\u5e8f\u4e3a\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"^")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"*"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"/"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"%")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"+"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"-")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"=="),", ",(0,l.kt)("inlineCode",{parentName:"li"},"!="),", ",(0,l.kt)("inlineCode",{parentName:"li"},"<="),", ",(0,l.kt)("inlineCode",{parentName:"li"},"<"),", ",(0,l.kt)("inlineCode",{parentName:"li"},">="),", ",(0,l.kt)("inlineCode",{parentName:"li"},">")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"and"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"unless")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"or"))),(0,l.kt)("p",null,"\u5177\u6709\u76f8\u540c\u4f18\u5148\u7ea7\u7684\u8fd0\u7b97\u7b26\u662f\u6ee1\u8db3\u7ed3\u5408\u5f8b\u7684\uff08\u5de6\u7ed3\u5408\uff09\u3002\u4f8b\u5982\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"2 * 3 % 2")," \u7b49\u4ef7\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"(2 * 3) % 2"),"\u3002\u8fd0\u7b97\u7b26 ",(0,l.kt)("inlineCode",{parentName:"p"},"^")," \u4f8b\u5916\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"^")," \u6ee1\u8db3\u7684\u662f\u53f3\u7ed3\u5408\uff0c\u4f8b\u5982\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"2 ^ 3 ^ 2")," \u7b49\u4ef7\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"2 ^ (3 ^ 2)"),"\u3002"),(0,l.kt)("h1",a({},{id:"\u5185\u7f6e\u51fd\u6570"}),"\u5185\u7f6e\u51fd\u6570"),(0,l.kt)("p",null,"Prometheus \u63d0\u4f9b\u4e86\u5176\u5b83\u5927\u91cf\u7684\u5185\u7f6e\u51fd\u6570\uff0c\u53ef\u4ee5\u5bf9\u65f6\u5e8f\u6570\u636e\u8fdb\u884c\u4e30\u5bcc\u7684\u5904\u7406\u3002\u67d0\u4e9b\u51fd\u6570\u6709\u9ed8\u8ba4\u7684\u53c2\u6570\uff0c\u4f8b\u5982\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"year(v=vector(time()) instant-vector)"),"\u3002\u5176\u4e2d\u53c2\u6570 ",(0,l.kt)("inlineCode",{parentName:"p"},"v")," \u662f\u4e00\u4e2a\u77ac\u65f6\u5411\u91cf\uff0c\u5982\u679c\u4e0d\u63d0\u4f9b\u8be5\u53c2\u6570\uff0c\u5c06\u4f7f\u7528\u9ed8\u8ba4\u503c ",(0,l.kt)("inlineCode",{parentName:"p"},"vector(time())"),"\u3002instant-vector \u8868\u793a\u53c2\u6570\u7c7b\u578b\u3002"),(0,l.kt)("h2",a({},{id:"abs"}),"abs()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"abs(v instant-vector)")," \u8fd4\u56de\u8f93\u5165\u5411\u91cf\u7684\u6240\u6709\u6837\u672c\u7684\u7edd\u5bf9\u503c\u3002"),(0,l.kt)("h2",a({},{id:"absent"}),"absent()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"absent(v instant-vector)"),"\uff0c\u5982\u679c\u4f20\u9012\u7ed9\u5b83\u7684\u5411\u91cf\u53c2\u6570\u5177\u6709\u6837\u672c\u6570\u636e\uff0c\u5219\u8fd4\u56de\u7a7a\u5411\u91cf\uff1b\u5982\u679c\u4f20\u9012\u7684\u5411\u91cf\u53c2\u6570\u6ca1\u6709\u6837\u672c\u6570\u636e\uff0c\u5219\u8fd4\u56de\u4e0d\u5e26\u5ea6\u91cf\u6307\u6807\u540d\u79f0\u4e14\u5e26\u6709\u6807\u7b7e\u7684\u65f6\u95f4\u5e8f\u5217\uff0c\u4e14\u6837\u672c\u503c\u4e3a1\u3002"),(0,l.kt)("p",null,"\u5f53\u76d1\u63a7\u5ea6\u91cf\u6307\u6807\u65f6\uff0c\u5982\u679c\u83b7\u53d6\u5230\u7684\u6837\u672c\u6570\u636e\u662f\u7a7a\u7684\uff0c \u4f7f\u7528 absent \u65b9\u6cd5\u5bf9\u544a\u8b66\u662f\u975e\u5e38\u6709\u7528\u7684\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'# \u8fd9\u91cc\u63d0\u4f9b\u7684\u5411\u91cf\u6709\u6837\u672c\u6570\u636e\nabsent(http_requests_total{method="get"})  => no data\nabsent(sum(http_requests_total{method="get"}))  => no data\n\n# \u7531\u4e8e\u4e0d\u5b58\u5728\u5ea6\u91cf\u6307\u6807 nonexistent\uff0c\u6240\u4ee5 \u8fd4\u56de\u4e0d\u5e26\u5ea6\u91cf\u6307\u6807\u540d\u79f0\u4e14\u5e26\u6709\u6807\u7b7e\u7684\u65f6\u95f4\u5e8f\u5217\uff0c\u4e14\u6837\u672c\u503c\u4e3a1\nabsent(nonexistent{job="myjob"})  => {job="myjob"}  1\n# \u6b63\u5219\u5339\u914d\u7684 instance \u4e0d\u4f5c\u4e3a\u8fd4\u56de labels \u4e2d\u7684\u4e00\u90e8\u5206\nabsent(nonexistent{job="myjob",instance=~".*"})  => {job="myjob"}  1\n\n# sum \u51fd\u6570\u8fd4\u56de\u7684\u65f6\u95f4\u5e8f\u5217\u4e0d\u5e26\u6709\u6807\u7b7e\uff0c\u4e14\u6ca1\u6709\u6837\u672c\u6570\u636e\nabsent(sum(nonexistent{job="myjob"}))  => {}  1\n')),(0,l.kt)("h2",a({},{id:"ceil"}),"ceil()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"ceil(v instant-vector)")," \u5c06 v \u4e2d\u6240\u6709\u5143\u7d20\u7684\u6837\u672c\u503c\u5411\u4e0a\u56db\u820d\u4e94\u5165\u5230\u6700\u63a5\u8fd1\u7684\u6574\u6570\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'node_load5{instance="192.168.1.75:9100"} # \u7ed3\u679c\u4e3a 2.79\nceil(node_load5{instance="192.168.1.75:9100"}) # \u7ed3\u679c\u4e3a 3\n')),(0,l.kt)("h2",a({},{id:"changes"}),"changes()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"changes(v range-vector)")," \u8f93\u5165\u4e00\u4e2a\u533a\u95f4\u5411\u91cf\uff0c \u8fd4\u56de\u8fd9\u4e2a\u533a\u95f4\u5411\u91cf\u5185\u6bcf\u4e2a\u6837\u672c\u6570\u636e\u503c\u53d8\u5316\u7684\u6b21\u6570\uff08\u77ac\u65f6\u5411\u91cf\uff09\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'# \u5982\u679c\u6837\u672c\u6570\u636e\u503c\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u5219\u8fd4\u56de\u7ed3\u679c\u4e3a 1\nchanges(node_load5{instance="192.168.1.75:9100"}[1m]) # \u7ed3\u679c\u4e3a 1\n')),(0,l.kt)("h2",a({},{id:"clamp_max"}),"clamp_max()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"clamp_max(v instant-vector, max scalar)")," \u51fd\u6570\uff0c\u8f93\u5165\u4e00\u4e2a\u77ac\u65f6\u5411\u91cf\u548c\u6700\u5927\u503c\uff0c\u6837\u672c\u6570\u636e\u503c\u82e5\u5927\u4e8e max\uff0c\u5219\u6539\u4e3a max\uff0c\u5426\u5219\u4e0d\u53d8\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'node_load5{instance="192.168.1.75:9100"} # \u7ed3\u679c\u4e3a 2.79\nclamp_max(node_load5{instance="192.168.1.75:9100"}, 2) # \u7ed3\u679c\u4e3a 2\n')),(0,l.kt)("h2",a({},{id:"clamp_min"}),"clamp_min()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"clamp_min(v instant-vector, min scalar)")," \u51fd\u6570\uff0c\u8f93\u5165\u4e00\u4e2a\u77ac\u65f6\u5411\u91cf\u548c\u6700\u5c0f\u503c\uff0c\u6837\u672c\u6570\u636e\u503c\u82e5\u5c0f\u4e8e min\uff0c\u5219\u6539\u4e3a min\uff0c\u5426\u5219\u4e0d\u53d8\u3002\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'node_load5{instance="192.168.1.75:9100"} # \u7ed3\u679c\u4e3a 2.79\nclamp_min(node_load5{instance="192.168.1.75:9100"}, 3) # \u7ed3\u679c\u4e3a 3\n')),(0,l.kt)("h2",a({},{id:"day_of_month"}),"day_of_month()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"day_of_month(v=vector(time()) instant-vector)")," \u51fd\u6570\uff0c\u8fd4\u56de\u88ab\u7ed9\u5b9a UTC \u65f6\u95f4\u6240\u5728\u6708\u7684\u7b2c\u51e0\u5929\u3002\u8fd4\u56de\u503c\u8303\u56f4\uff1a1~31\u3002"),(0,l.kt)("h2",a({},{id:"day_of_week"}),"day_of_week()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"day_of_week(v=vector(time()) instant-vector)")," \u51fd\u6570\uff0c\u8fd4\u56de\u88ab\u7ed9\u5b9a UTC \u65f6\u95f4\u6240\u5728\u5468\u7684\u7b2c\u51e0\u5929\u3002\u8fd4\u56de\u503c\u8303\u56f4\uff1a0~6\uff0c0 \u8868\u793a\u661f\u671f\u5929\u3002"),(0,l.kt)("h2",a({},{id:"days_in_month"}),"days_in_month()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"days_in_month(v=vector(time()) instant-vector)")," \u51fd\u6570\uff0c\u8fd4\u56de\u5f53\u6708\u4e00\u5171\u6709\u591a\u5c11\u5929\u3002\u8fd4\u56de\u503c\u8303\u56f4\uff1a28~31\u3002"),(0,l.kt)("h2",a({},{id:"delta"}),"delta()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"delta(v range-vector)")," \u7684\u53c2\u6570\u662f\u4e00\u4e2a\u533a\u95f4\u5411\u91cf\uff0c\u8fd4\u56de\u4e00\u4e2a\u77ac\u65f6\u5411\u91cf\u3002\u5b83\u8ba1\u7b97\u4e00\u4e2a\u533a\u95f4\u5411\u91cf v \u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u548c\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u4e4b\u95f4\u7684\u5dee\u503c\u3002\u7531\u4e8e\u8fd9\u4e2a\u503c\u88ab\u5916\u63a8\u5230\u6307\u5b9a\u7684\u6574\u4e2a\u65f6\u95f4\u8303\u56f4\uff0c\u6240\u4ee5\u5373\u4f7f\u6837\u672c\u503c\u90fd\u662f\u6574\u6570\uff0c\u4f60\u4ecd\u7136\u53ef\u80fd\u4f1a\u5f97\u5230\u4e00\u4e2a\u975e\u6574\u6570\u503c\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u8fd4\u56de\u8fc7\u53bb\u4e24\u5c0f\u65f6\u7684 CPU \u6e29\u5ea6\u5dee\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),'delta(cpu_temp_celsius{host="zeus"}[2h])\n')),(0,l.kt)("p",null,"\u8fd9\u4e2a\u51fd\u6570\u4e00\u822c\u53ea\u7528\u5728 Gauge \u7c7b\u578b\u7684\u65f6\u95f4\u5e8f\u5217\u4e0a\u3002"),(0,l.kt)("h2",a({},{id:"deriv"}),"deriv()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"deriv(v range-vector)")," \u7684\u53c2\u6570\u662f\u4e00\u4e2a\u533a\u95f4\u5411\u91cf,\u8fd4\u56de\u4e00\u4e2a\u77ac\u65f6\u5411\u91cf\u3002\u5b83\u4f7f\u7528\u7b80\u5355\u7684\u7ebf\u6027\u56de\u5f52\u8ba1\u7b97\u533a\u95f4\u5411\u91cf v \u4e2d\u5404\u4e2a\u65f6\u95f4\u5e8f\u5217\u7684\u5bfc\u6570\u3002"),(0,l.kt)("p",null,"\u8fd9\u4e2a\u51fd\u6570\u4e00\u822c\u53ea\u7528\u5728 Gauge \u7c7b\u578b\u7684\u65f6\u95f4\u5e8f\u5217\u4e0a\u3002"),(0,l.kt)("h2",a({},{id:"exp"}),"exp()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"exp(v instant-vector)")," \u51fd\u6570\uff0c\u8f93\u5165\u4e00\u4e2a\u77ac\u65f6\u5411\u91cf\uff0c\u8fd4\u56de\u5404\u4e2a\u6837\u672c\u503c\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"e")," \u7684\u6307\u6570\u503c\uff0c\u5373 e \u7684 N \u6b21\u65b9\u3002\u5f53 N \u7684\u503c\u8db3\u591f\u5927\u65f6\u4f1a\u8fd4\u56de ",(0,l.kt)("inlineCode",{parentName:"p"},"+Inf"),"\u3002\u7279\u6b8a\u60c5\u51b5\u4e3a\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Exp(+Inf) = +Inf")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Exp(NaN) = NaN"))),(0,l.kt)("h2",a({},{id:"floor"}),"floor()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"floor(v instant-vector)")," \u51fd\u6570\u4e0e ceil() \u51fd\u6570\u76f8\u53cd\uff0c\u5c06 v \u4e2d\u6240\u6709\u5143\u7d20\u7684\u6837\u672c\u503c\u5411\u4e0b\u56db\u820d\u4e94\u5165\u5230\u6700\u63a5\u8fd1\u7684\u6574\u6570\u3002"),(0,l.kt)("h2",a({},{id:"histogram_quantile"}),"histogram_quantile()"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"histogram_quantile(\u03c6 float, b instant-vector)")," \u4ece bucket \u7c7b\u578b\u7684\u5411\u91cf ",(0,l.kt)("inlineCode",{parentName:"p"},"b")," \u4e2d\u8ba1\u7b97 \u03c6 (0 \u2264 \u03c6 \u2264 1) \u5206\u4f4d\u6570\uff08\u767e\u5206\u4f4d\u6570\u7684\u4e00\u822c\u5f62\u5f0f\uff09\u7684\u6837\u672c\u7684\u6700\u5927\u503c\u3002\uff08\u6709\u5173 \u03c6 \u5206\u4f4d\u6570\u7684\u8be6\u7ec6\u8bf4\u660e\u4ee5\u53ca\u76f4\u65b9\u56fe\u6307\u6807\u7c7b\u578b\u7684\u4f7f\u7528\uff0c\u8bf7\u53c2\u9605",(0,l.kt)("a",a({parentName:"p"},{href:"https://prometheus.io/docs/practices/histograms"}),"\u76f4\u65b9\u56fe\u548c\u6458\u8981"),"\uff09\u3002\u5411\u91cf ",(0,l.kt)("inlineCode",{parentName:"p"},"b")," \u4e2d\u7684\u6837\u672c\u662f\u6bcf\u4e2a bucket \u7684\u91c7\u6837\u70b9\u6570\u91cf\u3002\u6bcf\u4e2a\u6837\u672c\u7684 labels \u4e2d\u5fc5\u987b\u8981\u6709 ",(0,l.kt)("inlineCode",{parentName:"p"},"le")," \u8fd9\u4e2a label \u6765\u8868\u793a\u6bcf\u4e2a bucket \u7684\u4e0a\u8fb9\u754c\uff0c\u6ca1\u6709 ",(0,l.kt)("inlineCode",{parentName:"p"},"le")," \u6807\u7b7e\u7684\u6837\u672c\u4f1a\u88ab\u5ffd\u7565\u3002\u76f4\u65b9\u56fe\u6307\u6807\u7c7b\u578b\u81ea\u52a8\u63d0\u4f9b\u5e26\u6709 ",(0,l.kt)("inlineCode",{parentName:"p"},"_bucket")," \u540e\u7f00\u548c\u76f8\u5e94\u6807\u7b7e\u7684\u65f6\u95f4\u5e8f\u5217\u3002"),(0,l.kt)("p",null,"\u53ef\u4ee5\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"rate()")," \u51fd\u6570\u6765\u6307\u5b9a\u5206\u4f4d\u6570\u8ba1\u7b97\u7684\u65f6\u95f4\u7a97\u53e3\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff0c\u4e00\u4e2a\u76f4\u65b9\u56fe\u6307\u6807\u540d\u79f0\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"employee_age_bucket_bucket"),"\uff0c\u8981\u8ba1\u7b97\u8fc7\u53bb 10 \u5206\u949f\u5185 \u7b2c 90 \u4e2a\u767e\u5206\u4f4d\u6570\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u8868\u8fbe\u5f0f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",a({parentName:"pre"},{}),"histogram_quantile(0.9, rate(employee_age_bucket_bucket[10m]))\n")),(0,l.kt)("p",null,"\u8fd4\u56de\uff1a"),(0,l.kt)("h1",a({},{id:"\u9677\u9631"}),"\u9677\u9631"),(0,l.kt)("h2",a({},{id:"\u5931\u6548"}),"\u5931\u6548"),(0,l.kt)("p",null,"\u6267\u884c\u67e5\u8be2\u64cd\u4f5c\u65f6\uff0c\u72ec\u7acb\u4e8e\u5f53\u524d\u65f6\u523b\u88ab\u9009\u4e2d\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u6240\u5bf9\u5e94\u7684\u65f6\u95f4\u6233\uff0c\u8fd9\u4e2a\u65f6\u95f4\u6233\u4e3b\u8981\u7528\u6765\u8fdb\u884c\u805a\u5408\u64cd\u4f5c\uff0c\u5305\u62ec ",(0,l.kt)("inlineCode",{parentName:"p"},"sum"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"avg")," \u7b49\uff0c\u5927\u591a\u6570\u805a\u5408\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u6240\u5bf9\u5e94\u7684\u65f6\u95f4\u6233\u6ca1\u6709\u5bf9\u9f50\u3002\u7531\u4e8e\u5b83\u4eec\u7684\u72ec\u7acb\u6027\uff0c\u6211\u4eec\u9700\u8981\u5728\u8fd9\u4e9b\u65f6\u95f4\u6233\u4e2d\u9009\u62e9\u4e00\u4e2a\u65f6\u95f4\u6233\uff0c\u5e76\u5df2\u8fd9\u4e2a\u65f6\u95f4\u6233\u4e3a\u57fa\u51c6\uff0c\u83b7\u53d6\u5c0f\u4e8e\u4e14\u6700\u63a5\u8fd1\u8fd9\u4e2a\u65f6\u95f4\u6233\u7684\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u3002"),(0,l.kt)("p",null,"\u5982\u679c\u91c7\u6837\u76ee\u6807\u6216\u544a\u8b66\u89c4\u5219\u4e0d\u518d\u8fd4\u56de\u4e4b\u524d\u5b58\u5728\u7684\u65f6\u95f4\u5e8f\u5217\u7684\u6837\u672c\uff0c\u5219\u8be5\u65f6\u95f4\u5e8f\u5217\u5c06\u88ab\u6807\u8bb0\u4e3a\u5931\u6548\u3002\u5982\u679c\u5220\u9664\u4e86\u91c7\u6837\u76ee\u6807\uff0c\u5219\u4e4b\u524d\u8fd4\u56de\u7684\u65f6\u95f4\u5e8f\u5217\u4e5f\u4f1a\u5f88\u5feb\u88ab\u6807\u8bb0\u4e3a\u5931\u6548\u3002"),(0,l.kt)("p",null,"\u5982\u679c\u5728\u67d0\u4e2a\u65f6\u95f4\u5e8f\u5217\u88ab\u6807\u8bb0\u4e3a\u5931\u6548\u540e\u5728\u8be5\u65f6\u95f4\u6233\u5904\u6267\u884c\u67e5\u8be2\u64cd\u4f5c\uff0c\u5219\u4e0d\u4f1a\u4e3a\u8be5\u65f6\u95f4\u5e8f\u5217\u8fd4\u56de\u4efb\u4f55\u503c\u3002\u5982\u679c\u968f\u540e\u5728\u8be5\u65f6\u95f4\u5e8f\u5217\u4e2d\u63d2\u5165\u4e86\u65b0\u7684\u6837\u672c\uff0c\u5219\u7167\u5e38\u8fd4\u56de\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u3002"),(0,l.kt)("p",null,"\u5982\u679c\u5728\u91c7\u6837\u65f6\u95f4\u6233\u524d 5 \u5206\u949f\uff08\u9ed8\u8ba4\u60c5\u51b5\uff09\u672a\u627e\u5230\u4efb\u4f55\u6837\u672c\uff0c\u5219\u8be5\u65f6\u95f4\u6233\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u4efb\u4f55\u8be5\u65f6\u95f4\u5e8f\u5217\u7684\u503c\u3002\u8fd9\u5b9e\u9645\u4e0a\u610f\u5473\u7740\u4f60\u5728\u56fe\u8868\u4e2d\u770b\u5230\u7684\u6570\u636e\u90fd\u662f\u5728\u5f53\u524d\u65f6\u523b 5 \u5206\u949f\u524d\u7684\u6570\u636e\u3002"),(0,l.kt)("p",null,"\u5bf9\u4e8e\u5728\u91c7\u6837\u70b9\u4e2d\u5305\u542b\u65f6\u95f4\u6233\u7684\u65f6\u95f4\u5e8f\u5217\uff0c\u4e0d\u4f1a\u88ab\u6807\u8bb0\u4e3a\u5931\u6548\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4ec5\u4f7f\u7528 5 \u5206\u949f\u9608\u503c\u68c0\u6d4b\u7684\u89c4\u5219\u3002"),(0,l.kt)("h2",a({},{id:"\u907f\u514d\u6162\u67e5\u8be2\u548c\u9ad8\u8d1f\u8f7d"}),"\u907f\u514d\u6162\u67e5\u8be2\u548c\u9ad8\u8d1f\u8f7d"),(0,l.kt)("p",null,"\u5982\u679c\u4e00\u4e2a\u67e5\u8be2\u9700\u8981\u64cd\u4f5c\u975e\u5e38\u5927\u7684\u6570\u636e\u91cf\uff0c\u56fe\u8868\u7ed8\u5236\u5f88\u53ef\u80fd\u4f1a\u8d85\u65f6\uff0c\u6216\u8005\u670d\u52a1\u5668\u8d1f\u8f7d\u8fc7\u9ad8\u3002\u56e0\u6b64\uff0c\u5728\u5bf9\u672a\u77e5\u6570\u636e\u6784\u5efa\u67e5\u8be2\u65f6\uff0c\u59cb\u7ec8\u9700\u8981\u5728 Prometheus \u8868\u8fbe\u5f0f\u6d4f\u89c8\u5668\u7684\u8868\u683c\u89c6\u56fe\u4e2d\u6784\u5efa\u67e5\u8be2\uff0c\u76f4\u5230\u7ed3\u679c\u662f\u770b\u8d77\u6765\u5408\u7406\u7684\uff08\u6700\u591a\u4e3a\u6570\u767e\u4e2a\uff0c\u800c\u4e0d\u662f\u6570\u5343\u4e2a\uff09\u3002\u53ea\u6709\u5f53\u4f60\u5df2\u7ecf\u5145\u5206\u8fc7\u6ee4\u6216\u8005\u805a\u5408\u6570\u636e\u65f6\uff0c\u624d\u5207\u6362\u5230\u56fe\u8868\u6a21\u5f0f\u3002\u5982\u679c\u8868\u8fbe\u5f0f\u7684\u67e5\u8be2\u7ed3\u679c\u4ecd\u7136\u9700\u8981\u5f88\u957f\u65f6\u95f4\u624d\u80fd\u7ed8\u5236\u51fa\u6765\uff0c\u5219\u9700\u8981\u901a\u8fc7\u8bb0\u5f55\u89c4\u5219\u91cd\u65b0\u6e05\u6d17\u6570\u636e\u3002"),(0,l.kt)("p",null,"\u50cf ",(0,l.kt)("inlineCode",{parentName:"p"},"api_http_requests_total")," \u8fd9\u6837\u7b80\u5355\u7684\u5ea6\u91cf\u6307\u6807\u540d\u79f0\u9009\u62e9\u5668\uff0c\u53ef\u4ee5\u6269\u5c55\u5230\u5177\u6709\u4e0d\u540c\u6807\u7b7e\u7684\u6570\u5343\u4e2a\u65f6\u95f4\u5e8f\u5217\u4e2d\uff0c\u8fd9\u5bf9\u4e8e Prometheus \u7684\u67e5\u8be2\u8bed\u8a00\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002\u8fd8\u8981\u8bb0\u4f4f\uff0c\u5bf9\u4e8e\u805a\u5408\u64cd\u4f5c\u6765\u8bf4\uff0c\u5373\u4f7f\u8f93\u51fa\u7684\u65f6\u95f4\u5e8f\u5217\u96c6\u975e\u5e38\u5c11\uff0c\u5b83\u4e5f\u4f1a\u5728\u670d\u52a1\u5668\u4e0a\u4ea7\u751f\u8d1f\u8f7d\u3002\u8fd9\u7c7b\u4f3c\u4e8e\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u4e00\u4e2a\u5b57\u6bb5\u7684\u603b\u548c\uff0c\u603b\u662f\u975e\u5e38\u7f13\u6162\u3002"))}s.isMDXComponent=!0}}]);