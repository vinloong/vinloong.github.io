"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9688],{3905:(e,n,r)=>{r.d(n,{Zo:()=>d,kt:()=>m});var t=r(7294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function o(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},s=Object.keys(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=t.createContext({}),i=function(e){var n=t.useContext(c),r=n;return e&&(r="function"==typeof e?e(n):o(o({},n),e)),r},d=function(e){var n=i(e.components);return t.createElement(c.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},k=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,s=e.originalType,c=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=i(r),k=a,m=u["".concat(c,".").concat(k)]||u[k]||p[k]||s;return r?t.createElement(m,o(o({ref:n},d),{},{components:r})):t.createElement(m,o({ref:n},d))}));function m(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=r.length,o=new Array(s);o[0]=k;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l[u]="string"==typeof e?e:a,o[1]=l;for(var i=2;i<s;i++)o[i]=r[i];return t.createElement.apply(null,o)}return t.createElement.apply(null,r)}k.displayName="MDXCreateElement"},4495:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>k,frontMatter:()=>o,metadata:()=>c,toc:()=>d});r(7294);var t=r(3905);function a(){return a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},a.apply(this,arguments)}function s(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},s=Object.keys(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const o={},l="Install Docker",c={unversionedId:"kubernetes/containers/docker_install",id:"kubernetes/containers/docker_install",title:"Install Docker",description:"Install",source:"@site/docs/kubernetes/containers/docker_install.md",sourceDirName:"kubernetes/containers",slug:"/kubernetes/containers/docker_install",permalink:"/docs/kubernetes/containers/docker_install",draft:!1,tags:[],version:"current",lastUpdatedAt:1675912862,formattedLastUpdatedAt:"2023\u5e742\u67089\u65e5",frontMatter:{},sidebar:"kubernetes",previous:{title:"Ubuntu \u4e2d\u5b89\u88c5 Docker CE",permalink:"/docs/kubernetes/containers/docker-install"},next:{title:"docker_volume",permalink:"/docs/kubernetes/containers/docker_volume"}},i={},d=[{value:"Install",id:"install",level:2},{value:"\u5bb9\u5668\u547d\u4ee4\u884c\u5de5\u5177",id:"\u5bb9\u5668\u547d\u4ee4\u884c\u5de5\u5177",level:2},{value:"\u5f00\u542f\xa0docker \u8fdc\u7a0bTCP\u8bbf\u95ee",id:"\u5f00\u542fdocker-\u8fdc\u7a0btcp\u8bbf\u95ee",level:2},{value:"\u8bbf\u95ee\u79c1\u6709\u955c\u50cf\u4ed3\u5e93",id:"\u8bbf\u95ee\u79c1\u6709\u955c\u50cf\u4ed3\u5e93",level:2},{value:"install docker in WSL",id:"install-docker-in-wsl",level:2},{value:"jenkins",id:"jenkins",level:2},{value:"mysql",id:"mysql",level:2},{value:"redis",id:"redis",level:2},{value:"ES",id:"es",level:2}],u={toc:d},p="wrapper";function k(e){var{components:n}=e,r=s(e,["components"]);return(0,t.kt)(p,a({},u,r,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("h1",a({},{id:"install-docker"}),"Install Docker"),(0,t.kt)("h2",a({},{id:"install"}),"Install"),(0,t.kt)("p",null,"ubuntu 16.04"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),'# \u5378\u8f7d\u65e7\u7248\u672c\uff1a\nsudo apt-get remove docker docker-engine docker.io\n\nsudo apt-get update\n\n## ubuntu 14.04 \u5b89\u88c5\u5185\u6838\u53ef\u9009\u6a21\u5757\nsudo apt-get install \\\nlinux-image-extra-$(uname -r) \\\nlinux-image-extra-virtual\n## end\n\n\n# \u5b89\u88c5https\nsudo apt-get install \\\napt-transport-https \\\nca-certificates \\\ncurl \\\nsoftware-properties-common\n\n# \u5b89\u88c5\u6e90\n\n# \u56fd\u5185\u6e90\ncurl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key    add -\nsudo add-apt-repository \\\n"deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu \\\n$(lsb_release -cs) \\\nstable"\n# \u5b98\u65b9\u6e90\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nsudo add-apt-repository \\\n"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\\n$(lsb_release    -cs) \\\nstable"\n\n# \u5b89\u88c5docker-ce\nsudo apt-get update\n\nsudo apt-get install docker-ce\n\n# \u8fd8\u53ef\u4ee5\u811a\u672c\u81ea\u52a8\u5b89\u88c5\ncurl -fsSL get.docker.com -o get-docker.sh \nsudo sh get-docker.sh --mirror Aliyun\n\n# \u542f\u52a8docker\nsudo systemctl enable docker \nsudo systemctl start docker\n\n## ubuntu 14.04 \nsudo service docker start\n## end\n\n# \u589e\u52a0docker \u7528\u6237\u7ec4 \n# \u7528\u6237\u7ec4\u5728\u5b89\u88c5\u5b8cdocker\u81ea\u52a8\u589e\u52a0\u7684\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u624b\u52a8\u589e\u52a0\nsudo groupadd docker\n# \u5c06\u5f53\u524d\u7528\u6237\u589e\u52a0\u5230docker\u7ec4\nsudo usermod -aG docker $USER\n\n# \u8bbe\u7f6e\u955c\u50cf\u52a0\u901f\u5668\n# \u5728\u963f\u91cc\u6ce8\u518c\u7533\u8bf7\u52a0\u901f\u5668\n# https://1f3mevbc.mirror.aliyuncs.com\n\n# \u7f16\u8f91  /etc/systemd/system/multi-user.target.wants/docker.service \u6587\u4ef6\n# \u627e\u5230  ExecStart= \u8ffd\u52a0  --registry-mirror=https://1f3mevbc.mirror.aliyuncs.com\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n\n## ubuntu 14.04 \n## \u7f16\u8f91/etc/default/docker\u6587\u4ef6, DOCKER_OPTS\u8ffd\u52a0  --registry-mirror=https://1f3mevbc.mirror.aliyuncs.com\nsudo service docker restart\n## end\n')),(0,t.kt)("h2",a({},{id:"\u5bb9\u5668\u547d\u4ee4\u884c\u5de5\u5177"}),"\u5bb9\u5668\u547d\u4ee4\u884c\u5de5\u5177"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"# docker \nsudo docker exec -it 775c7c9ee1e1 /bin/bash\n\n# \u7b2c\u4e09\u65b9\u5de5\u5177\nsudo apt-get install util-linux\nsudo docker ps\n# \u8fdb\u5165\u5bb9\u5668\ntpid=`sudo docker inspect -f {{.State.Pid}} 404d5b9dc923`\nsudo nsenter --target $tpid --mount --uts --ipc --net --pid\n")),(0,t.kt)("h2",a({},{id:"\u5f00\u542fdocker-\u8fdc\u7a0btcp\u8bbf\u95ee"}),"\u5f00\u542f\xa0docker \u8fdc\u7a0bTCP\u8bbf\u95ee"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"# \n# \u7f16\u8f91 /etc/systemd/system/multi-user.target.wants/docker.service \u6587\u4ef6\n# \u627e\u5230 ExecStart= \u8ffd\u52a0 -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n")),(0,t.kt)("h2",a({},{id:"\u8bbf\u95ee\u79c1\u6709\u955c\u50cf\u4ed3\u5e93"}),"\u8bbf\u95ee\u79c1\u6709\u955c\u50cf\u4ed3\u5e93"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),'# \u4e0d\u80fd\u8bbf\u95ee\u79c1\u6709http\u4ed3\u5e93\n# \u89e3\u51b3\u65b9\u6cd5\uff1a\n# 1. \u7f16\u8f91 /etc/docker/daemon.json \u6587\u4ef6\n# {"insecure-registries" : ["10.8.30.163:5005"]}\n\n# 2. \u7f16\u8f91  /etc/systemd/system/multi-user.target.wants/docker.service \u6587\u4ef6\n# \u627e\u5230  ExecStart= \u8ffd\u52a0 --insecure-registry 10.8.30.163:5005\n')),(0,t.kt)("h2",a({},{id:"install-docker-in-wsl"}),"install docker in WSL"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"\u5148\u542f\u7528 Hyper-V")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"\u5b89\u88c5 docker for windows")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"\u5728 WSL ubuntu \u4e2d\u6309\u7167\u4e0a\u9762\u7684\u6b65\u9aa4\u5b89\u88c5 docker, \u6267\u884c\u547d\u4ee4 ",(0,t.kt)("inlineCode",{parentName:"p"},"docker --version")," ")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"\u6267\u884c ",(0,t.kt)("inlineCode",{parentName:"p"},'echo "export DOCKER_HOST=tcp://localhost:2375" >> ~/.bashrc && source ~/.bashrc')))),(0,t.kt)("h1",a({},{id:"\u5b9e\u8df5"}),"\u5b9e\u8df5"),(0,t.kt)("h2",a({},{id:"jenkins"}),"jenkins"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"docker pull jenkins\nsudo mkdir /docker/jenkins\nsudo chown 1000:1000 /var/jenkins\n\nsudo docker run \\\n-d \\\n-p 8088:8080 -p 50005:50000 \\\n-v /docker/jenkins/:/var/jenkins_home \\\n-v /versions:/versions \\\n-v ~/.ssh:/var/jenkins_home/.ssh \\\n-v /etc/localtime:/etc/localtime:ro \\\n-v /var/run/docker.sock:/var/run/docker.sock \\\n-v $(which docker):/usr/bin/docker \\\n-e JAVA_OPTS=-Duser.timezone=Asia/Shanghai \\\n--restart=always \\\n--name=myjenkins 10.8.30.163:5005/jenkins:10.28\n\n# \u5171\u4eab\u4e3b\u673a /var/run/docker.sock \u540e\uff0cjenkins \u6267\u884cdocker \u4f1a\u63d0\u793a\u6ca1\u6709\u6743\u9650\n# \u8fdb\u5165Jenkins \u5bb9\u5668 \nchown 1000:1000 /var/run/docker.sock\n")),(0,t.kt)("h2",a({},{id:"mysql"}),"mysql"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"# \u6302\u8f7d\u914d\u7f6e\u6587\u4ef6\u548c\u6570\u636e\u76ee\u5f55\u5230\u5bbf\u4e3b\u673a\ndocker run -d \\\n--name mysql \\\n-p 3306:3306 \\\n-v /docker/mysql/config/mysqld.cnf:/etc/mysql/mysql.conf.d/mysqld.cnf \\\n-v /docker/mysql/data/mysql:/var/lib/mysql \\\n-e MYSQL_ROOT_PASSWORD=123456 \\\n--restart=always \\\n--name=db_mysql \\ \nmysql:5.7\n")),(0,t.kt)("h2",a({},{id:"redis"}),"redis"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"docker run -d \\\n-p 6379:6379 \\\n-v /docker/redis/redis.conf:/etc/redis/redis.conf \\\n-v /docker/redis/data:/data \\\n--name redis \\\nredis:alpine \nredis-server /etc/redis/redis.conf --appendonly yes\n")),(0,t.kt)("h2",a({},{id:"es"}),"ES"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"docker run -d \\\n-p 9200:9200 \\\n-p 9300:9300 \\\n-v /docker/es/config:/usr/share/elasticsearch/config \\\n-v /docker/es/data:/usr/share/elasticsearch/data \\\n-v /docker/es/plugins:/usr/share/elasticsearch/plugins \\\n--name es \\\nelasticsearch:6.5.0 \n")),(0,t.kt)("h1",a({},{id:"\u521b\u5efa\u79c1\u6709\u955c\u50cf\u4ed3\u5e93"}),"\u521b\u5efa\u79c1\u6709\u955c\u50cf\u4ed3\u5e93"),(0,t.kt)("pre",null,(0,t.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"docker run -d -p 5005:5000 -v /my_registry:/var/lib/registry --restart=always --name registry-srv registry:2\n\ndocker run -it -p 8088:8080 --restart=always --name registry-web --link registry-srv -e REGISTRY_URL=http://10.8.30.163:5005/v2 -e REGISTRY_NAME=10.8.30.163:5005 hyper/docker-registry-web\n")),(0,t.kt)("h1",a({},{id:"\u83b7\u53d6\u955c\u50cf\u52a0\u901f\u5730\u5740"}),"\u83b7\u53d6\u955c\u50cf\u52a0\u901f\u5730\u5740"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("strong",{parentName:"p"},"\u9996\u5148\u4f60\u8981\u6709\u4e00\u4e2a\u963f\u91cc\u4e91\u8d26\u53f7"))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"\u76f4\u63a5\u8df3\u8f6c\u5230\u5bb9\u5668\u955c\u50cf\u670d\u52a1\u9875\u9762 ",(0,t.kt)("a",a({parentName:"p"},{href:"https://cr.console.aliyun.com/"}),"https://cr.console.aliyun.com/"))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"\u4fa7\u8fb9\u680f ",(0,t.kt)("em",{parentName:"p"},"\u955c\u50cf\u4e2d\u5fc3")," --\x3e ",(0,t.kt)("em",{parentName:"p"},"\u955c\u50cf\u52a0\u901f\u5668"),"  "),(0,t.kt)("p",{parentName:"li"},(0,t.kt)("img",a({parentName:"p"},{src:"https://raw.githubusercontent.com/vinloong/imgchr/main/notes/img/001.png",alt:null}))))))}k.isMDXComponent=!0}}]);