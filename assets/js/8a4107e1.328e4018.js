"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6438],{3905:(e,t,r)=>{r.d(t,{Zo:()=>k,kt:()=>f});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),l=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):p(p({},t),e)),r},k=function(e){var t=l(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,k=i(e,["components","mdxType","originalType","parentName"]),c=l(r),m=a,f=c["".concat(s,".").concat(m)]||c[m]||u[m]||o;return r?n.createElement(f,p(p({ref:t},k),{},{components:r})):n.createElement(f,p({ref:t},k))}));function f(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,p=new Array(o);p[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:a,p[1]=i;for(var l=2;l<o;l++)p[l]=r[l];return n.createElement.apply(null,p)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},6626:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>p,metadata:()=>s,toc:()=>k});r(7294);var n=r(3905);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const p={index:!1,icon:"linux",title:"kafka install",date:new Date("2022-04-18T00:00:00.000Z"),category:["linux"],tag:["kafka"]},i="\u5229\u7528Ambari \u5b89\u88c5",s={unversionedId:"linux/kafka-install.md",id:"linux/kafka-install.md",title:"kafka install",description:"kafka \u76ee\u5f55 \uff1a /usr/hdp/current/kafka-broker",source:"@site/docs/linux/kafka-install.md.md",sourceDirName:"linux",slug:"/linux/kafka-install.md",permalink:"/docs/linux/kafka-install.md",draft:!1,tags:[],version:"current",lastUpdatedAt:1675912862,formattedLastUpdatedAt:"2023\u5e742\u67089\u65e5",frontMatter:{index:!1,icon:"linux",title:"kafka install",date:"2022-04-18T00:00:00.000Z",category:["linux"],tag:["kafka"]},sidebar:"linux",previous:{title:"install-jdk8-on-ubuntu",permalink:"/docs/linux/install-jdk8-on-ubuntu"},next:{title:"linux kernel params \u4f18\u5316",permalink:"/docs/linux/kernel params \u4f18\u5316"}},l={},k=[{value:"zookeeper",id:"zookeeper",level:3},{value:"kafka",id:"kafka",level:3}],c={toc:k},u="wrapper";function m(e){var{components:t}=e,r=o(e,["components"]);return(0,n.kt)(u,a({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",a({},{id:"\u5229\u7528ambari-\u5b89\u88c5"}),"\u5229\u7528Ambari \u5b89\u88c5"),(0,n.kt)("p",null,"kafka \u76ee\u5f55 \uff1a ",(0,n.kt)("inlineCode",{parentName:"p"},"/usr/hdp/current/kafka-broker")),(0,n.kt)("h1",a({},{id:"\u624b\u52a8\u5b89\u88c5"}),"\u624b\u52a8\u5b89\u88c5"),(0,n.kt)("h3",a({},{id:"zookeeper"}),"zookeeper"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"kafka \u4f9d\u8d56zookeeper \u7ba1\u7406\u81ea\u8eab\u96c6\u7fa4(Broker, Offset, Producer, Consumer\u7b49),\u6240\u4ee5\u8981\u5148\u5b89\u88c5zookeeper.")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u4e0b\u8f7d "),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{}),"wget http://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz\n\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u89e3\u538b"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{}),"    tar -zxvf zookeeper-3.4.10.tar.gz\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u914d\u7f6e"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"    cd zookeeper-3.4.10/conf\n    cp zoo_sample.cfg zoo.cfg\n    # \u4fee\u6539 dataDir(\u6570\u636e\u4fdd\u5b58\u8def\u5f84): \u8def\u5f84\u540e\u9762\u4e0d\u80fd\u6709\u6ce8\u91ca\n    dataDir=/home/test/zookeeper-3.4.10/data\n    # \u589e\u52a0\u96c6\u7fa4\u914d\u7f6e\u8282\u70b9 hostname:port1:port2  port1 \u662fnode\u95f4\u7684\u901a\u4fe1\u7aef\u53e3\uff0c\n    # port2\u662f\u9009\u4e3e\u7aef\u53e3\n    server.0=test-n4:4001:4002\n    server.1=test-n5:4001:4002\n    server.2=test-n6:4001:4002\n")),(0,n.kt)("blockquote",{parentName:"li"},(0,n.kt)("p",{parentName:"blockquote"},"zookeeper \u9ed8\u8ba4\u670d\u52a1\u7aef\u53e3\u662f\uff1a2181")),(0,n.kt)("blockquote",{parentName:"li"},(0,n.kt)("p",{parentName:"blockquote"},"\u5728\u4e0a\u8ff0\u914d\u7f6e\u7684dataDir\u8def\u5f84\u4e0b\u521b\u5efa\u4e00\u4e2a myid \u6587\u4ef6")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{className:"language-bash"})," # \u6bcf\u4e2a\u8282\u70b9\u90fd\u589e\u52a0 myid \u5185\u5bb9\u662f\u8282\u70b9\u7f16\u53f7\n echo '0' >> myid\n # echo '1' >> myid\n # echo '2' >> myid\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u8fd0\u884c"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"bin/zkServer.sh start\n# \u67e5\u770b\u72b6\u6001\nbin/zkServer.sh status\n")),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{})," test@test-n3:~/services/zookeeper$ bin/zkServer.sh status\n ZooKeeper JMX enabled by default\n Using config: /home/test/services/zookeeper/bin/../conf/zoo.cfg\n Mode: leader\n\n test@test-n1:~/services/zookeeper$ bin/zkServer.sh status\n ZooKeeper JMX enabled by default\n Using config: /home/test/services/zookeeper/bin/../conf/zoo.cfg\n Mode: follower\n\n test@test-n3:~/services/zookeeper$ bin/zkServer.sh status\n ZooKeeper JMX enabled by default\n Using config: /home/test/services/zookeeper/bin/../conf/zoo.cfg\n Mode: leader\n\n")),(0,n.kt)("blockquote",{parentName:"li"},(0,n.kt)("p",{parentName:"blockquote"},"test-n3 \u662fleader"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u505c\u6b62"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{}),"bin/zkServer.sh stop\n")))),(0,n.kt)("h3",a({},{id:"kafka"}),"kafka"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u4e0b\u8f7d\u5e76\u89e3\u538b"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{}),"wget http://mirror.bit.edu.cn/apache/kafka/0.11.0.1/kafka_2.12-0.11.0.1.tgz\ntar -zxvf kafka_2.12-0.11.0.1.tgz\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u914d\u7f6e"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"cd kafka_2.12-0.11.0.1\nvi config/server.properties\n# \u4fee\u6539\nbroker.id=0 # \u6bcf\u4e2a\u8282\u70b9\u4e0d\u80fd\u76f8\u540c 1, 2\ndelete.topic.enable=true\nlisteners=PLAINTEXT://test-n1:9092\nlog.dirs=/home/anxin/kafka_2.12-0.11.0.1/kafka-logs\nzookeeper.connect=test-n1:2181,test-n2:2181,test-n3:2181\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u542f\u52a8"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{}),"bin/kafka-server-start.sh -daemon config/server.properties\n\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u67e5\u770btopic\u72b6\u6001"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{}),"```\nbin/kafka-topics.sh --describe --zookeeper test-n1:2181,test-n2:2181,test-n3:2181 \n")),(0,n.kt)("p",{parentName:"li"},"--topic data"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{}),"```\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u5e38\u7528\u547d\u4ee4"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{}),"``` bash\n# \u521b\u5efa\u4e00\u4e2a\u540d\u4e3adata\u7684topic, \u62e5\u67091\u4e2a\u5206\u533a\uff0c1\u4e2a\u526f\u672c\n./kafka-topics.sh --create --zookeeper test-n1:2181,test-n2:2181,test-n3:2181 --replication-factor 1 --partitions 1 --topic topic_test\n\n# \u67e5\u770b\u6240\u6709topics\n")),(0,n.kt)("p",{parentName:"li"},"./kafka-topics.sh --list --zookeeper test-n1:2181\n"))),(0,n.kt)("h1",a({},{id:"\u67e5\u770btopic\u7684\u72b6\u6001"}),"\u67e5\u770btopic\u7684\u72b6\u6001"),(0,n.kt)("pre",null,(0,n.kt)("code",a({parentName:"pre"},{}),"./kafka-topics.sh --zookeeper test-n1:2181,test-n2:2181,test-n3:2181 --describe  --topic topic_test\n")),(0,n.kt)("h1",a({},{id:"\u63a7\u5236\u53f0\u751f\u4ea7\u6570\u636e-broker-ambari-\u5b89\u88c5\u7684\u4f7f\u75286667\u7aef\u53e3-\u81ea\u5df1\u624b\u52a8\u5b89\u88c5\u7684\u4f7f\u7528-9092-\u7aef\u53e3"}),"\u63a7\u5236\u53f0\u751f\u4ea7\u6570\u636e broker ambari \u5b89\u88c5\u7684\u4f7f\u75286667\u7aef\u53e3 \uff0c\u81ea\u5df1\u624b\u52a8\u5b89\u88c5\u7684\u4f7f\u7528 9092 \u7aef\u53e3"),(0,n.kt)("pre",null,(0,n.kt)("code",a({parentName:"pre"},{}),"./kafka-console-producer.sh --broker-list test-n1:6667 --topic topic_test\n")),(0,n.kt)("h1",a({},{id:"\u63a7\u5236\u53f0\u6d88\u8d39"}),"\u63a7\u5236\u53f0\u6d88\u8d39"),(0,n.kt)("pre",null,(0,n.kt)("code",a({parentName:"pre"},{}),"./kafka-console-consumer.sh --bootstrap-server test-n1:6667 --topic topic_test --from-beginning\n\n# \u67e5\u770btopic\u67d0\u5206\u533a\u504f\u79fb\u91cf\u6700\u5927\uff08\u5c0f\uff09\u503c: time\u4e3a-1\u65f6\u8868\u793a\u6700\u5927\u503c,time\u4e3a-2\u65f6\u8868\u793a\u6700\u5c0f\u503c\n./kafka-run-class.sh kafka.tools.GetOffsetShell --topic test_data --time -1 --broker-list test-n1:6667 --partitions 0\n# \u67e5\u770btopic \u504f\u79fb\u91cf\u6700\u5927\uff08\u5c0f\uff09\u503c: time\u4e3a-1\u65f6\u8868\u793a\u6700\u5927\u503c,time\u4e3a-2\u65f6\u8868\u793a\u6700\u5c0f\u503c\n./kafka-run-class.sh kafka.tools.GetOffsetShell --topic test_data --time -1 --broker-list test-n1:6667\n\n# \u4fee\u6539 topic test_data \u5206\u533a 10 (\u53ea\u80fd\u589e\u52a0\u4e0d\u80fd\u51cf\u5c11)\n./kafka-topics.sh --zookeeper test-n1:2181 --alter --topic test_data --partitions 10\n\n# \u67e5\u770b consumer group \u5217\u8868\n./kafka-consumer-groups.sh --new-consumer --bootstrap-server test-n1:6667 --list\n# ./kafka-consumer-groups.sh --zookeeper test-n1:2181 --list\n\n# \u67e5\u770b\u7279\u5b9aconsumer group \u8be6\u60c5\n./kafka-consumer-groups.sh --new-consumer --bootstrap-server test-n1:6667 --group test --describe\n# /kafka-consumer-groups.sh --zookeeper test-n1:2181 --group console-consumer-11967 --describe\n\n```\n")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u5220\u9664 topic"),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"# \u5220\u9664topic\n./kafka-topics.sh --delete --zookeeper test-n1:2181 --topic topic_test\n./kafka-run-class.sh kafka.admin.DeleteTopicCommand --zookeeper test-n1:2181 --topic topic_test\n\n# \u5982\u679c `delete.topic.enable=true` \u5219\u76f4\u63a5\u5220\u9664\uff0c\u5426\u5219topic\u4ec5\u4ec5\u88ab\u6807\u8bb0\u4e3a\u5220\u9664\n\n# \u4ecezk\u4e2d\u5220\u9664topic ; \u5220\u9664\u5b8c\u6210\u540e\u91cd\u542fzookeeper\u548ckafka\u670d\u52a1\uff1b\n./zkCli.sh\nls /brokers/topics\nrm /brokers/topics/topic_test\n\n")))))}m.isMDXComponent=!0}}]);