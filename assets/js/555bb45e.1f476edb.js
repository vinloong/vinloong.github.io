"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3757],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>f});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),i=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=i(e.components);return r.createElement(p.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=i(t),m=a,f=u["".concat(p,".").concat(m)]||u[m]||d[m]||o;return t?r.createElement(f,s(s({ref:n},c),{},{components:t})):r.createElement(f,s({ref:n},c))}));function f(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,s=new Array(o);s[0]=m;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[u]="string"==typeof e?e:a,s[1]=l;for(var i=2;i<o;i++)s[i]=t[i];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},1070:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>p,toc:()=>c});t(7294);var r=t(3905);function a(){return a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},a.apply(this,arguments)}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}const s={},l="k8s \u4f7f\u7528\u7684\u4e00\u4e9b\u6280\u5de7",p={unversionedId:"kubernetes/sexy-tips",id:"kubernetes/sexy-tips",title:"k8s \u4f7f\u7528\u7684\u4e00\u4e9b\u6280\u5de7",description:"\u5728\u5bb9\u5668\u4e2d\u83b7\u53d6pod \u7684IP",source:"@site/docs/kubernetes/sexy-tips.md",sourceDirName:"kubernetes",slug:"/kubernetes/sexy-tips",permalink:"/docs/kubernetes/sexy-tips",draft:!1,tags:[],version:"current",lastUpdatedAt:1675912862,formattedLastUpdatedAt:"2023\u5e742\u67089\u65e5",frontMatter:{},sidebar:"kubernetes",previous:{title:"reserve-compute-resources",permalink:"/docs/kubernetes/reserve-compute-resources"},next:{title:"\u5377",permalink:"/docs/kubernetes/storage/volumes"}},i={},c=[{value:"\u5728\u5bb9\u5668\u4e2d\u83b7\u53d6pod \u7684IP",id:"\u5728\u5bb9\u5668\u4e2d\u83b7\u53d6pod-\u7684ip",level:2},{value:"pod \u4f7f\u7528\u5916\u90e8DNS",id:"pod-\u4f7f\u7528\u5916\u90e8dns",level:2},{value:"\u521b\u5efa\u4e00\u4e2aUbuntu\u6d4b\u8bd5\u5bb9\u5668",id:"\u521b\u5efa\u4e00\u4e2aubuntu\u6d4b\u8bd5\u5bb9\u5668",level:2},{value:"\u5f3a\u5236\u5220\u9664\u67d0 pod",id:"\u5f3a\u5236\u5220\u9664\u67d0-pod",level:2},{value:"\u4f7f\u5bb9\u5668\u5185\u65f6\u95f4\u4e0e\u5bbf\u4e3b\u673a\u540c\u6b65",id:"\u4f7f\u5bb9\u5668\u5185\u65f6\u95f4\u4e0e\u5bbf\u4e3b\u673a\u540c\u6b65",level:2}],u={toc:c},d="wrapper";function m(e){var{components:n}=e,t=o(e,["components"]);return(0,r.kt)(d,a({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",a({},{id:"k8s-\u4f7f\u7528\u7684\u4e00\u4e9b\u6280\u5de7"}),"k8s \u4f7f\u7528\u7684\u4e00\u4e9b\u6280\u5de7"),(0,r.kt)("h2",a({},{id:"\u5728\u5bb9\u5668\u4e2d\u83b7\u53d6pod-\u7684ip"}),"\u5728\u5bb9\u5668\u4e2d\u83b7\u53d6pod \u7684IP"),(0,r.kt)("p",null,"\u8bbe\u7f6e\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\u6765\u5f15\u7528 resource \u7684\u72b6\u6001\u5b57\u6bb5\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-yaml"}),"kind: StatefulSet\napiVersion: apps/v1\nmetadata:\n  name: redis-app\n  namespace: ops\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis\n  template:\n    metadata:\n      labels:\n        app: redis\n    spec:\n      containers:\n        - name: redis\n          image: 'redis:5.0'\n          command:\n            - redis-server\n          args:\n            - /etc/redis/redis.conf\n            - '--protected-mode'\n            - 'no'\n            - '--cluster-announce-ip'\n            - $(POD_IP)\n          ports:\n            - name: redis\n              containerPort: 6379\n              protocol: TCP\n          env:\n            - name: POD_IP\n              valueFrom:\n                fieldRef:\n                  apiVersion: v1\n                  fieldPath: status.podIP\n\n")),(0,r.kt)("h2",a({},{id:"pod-\u4f7f\u7528\u5916\u90e8dns"}),"pod \u4f7f\u7528\u5916\u90e8DNS"),(0,r.kt)("p",null,"\u4fee\u6539 ",(0,r.kt)("inlineCode",{parentName:"p"},"coredns")," \u7684\u4f7f\u7528\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"ConfigMap")),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-yaml"}),"apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: coredns\n  namespace: kube-system\ndata:\n  Corefile: |\n    .:53 {\n        errors\n        health {\n          lameduck 5s\n        }\n        hosts {\n          10.8.30.157  test-master\n          10.8.30.152  test-n1\n          10.8.30.156  test-n2\n          10.8.30.155  test-n3\n          10.8.30.161  test-n4\n          10.8.30.141  test-n5\n          10.8.30.35   node35\n          10.8.30.36   node36\n          10.8.30.37   node37\n          10.8.30.38   node38\n          fallthrough\n        }\n        ready\n        kubernetes cluster.local in-addr.arpa ip6.arpa {\n          pods insecure\n          fallthrough  in-addr.arpa ip6.arpa\n          ttl 30\n        }\n        prometheus :9153\n        # upstreamNameservers\n        forward . 114.114.114.114 223.5.5.5 {\n          max_concurrent 1000\n        }\n        cache 30\n        loop\n        reload\n        loadbalance\n    }\n    # stubDomains\n    k8s.com:53 {\n      errors\n      cache 30\n      forward . 192.168.10.10\n    } \n      \n")),(0,r.kt)("h2",a({},{id:"\u521b\u5efa\u4e00\u4e2aubuntu\u6d4b\u8bd5\u5bb9\u5668"}),"\u521b\u5efa\u4e00\u4e2aUbuntu\u6d4b\u8bd5\u5bb9\u5668"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-yaml"}),'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  matchLabels:\n    app: test\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: test\n    spec:\n      containers:\n      - image: ubuntu:20.04\n        name: test\n        command: ["/bin/bash","-c","while true; do sleep 1000; done"]\n        imagePullPolicy: IfNotPresent\n')),(0,r.kt)("h2",a({},{id:"\u5f3a\u5236\u5220\u9664\u67d0-pod"}),"\u5f3a\u5236\u5220\u9664\u67d0 pod"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-shell"}),"kubectl delete pod <pod>  [-n <namespace>] --force --grace-period=0\n")),(0,r.kt)("h2",a({},{id:"\u4f7f\u5bb9\u5668\u5185\u65f6\u95f4\u4e0e\u5bbf\u4e3b\u673a\u540c\u6b65"}),"\u4f7f\u5bb9\u5668\u5185\u65f6\u95f4\u4e0e\u5bbf\u4e3b\u673a\u540c\u6b65"),(0,r.kt)("p",null,"\u6211\u4eec\u4e0b\u8f7d\u7684\u5f88\u591a\u5bb9\u5668\u5185\u7684\u65f6\u533a\u90fd\u662f\u683c\u6797\u5c3c\u6cbb\u65f6\u95f4\uff0c\u4e0e\u5317\u4eac\u65f6\u95f4\u5dee8\u5c0f\u65f6\uff0c\u8fd9\u5c06\u5bfc\u81f4\u5bb9\u5668\u5185\u7684\u65e5\u5fd7\u548c\u6587\u4ef6\u521b\u5efa\u65f6\u95f4\u4e0e\u5b9e\u9645\u65f6\u533a\u4e0d\u7b26\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4fee\u6539\u955c\u50cf\u4e2d\u7684\u65f6\u533a\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("li",{parentName:"ul"},"\u5c06\u5bbf\u4e3b\u673a\u7684\u65f6\u533a\u914d\u7f6e\u6587\u4ef6",(0,r.kt)("inlineCode",{parentName:"li"},"/etc/localtime"),"\u4f7f\u7528volume\u65b9\u5f0f\u6302\u8f7d\u5230\u5bb9\u5668\u4e2d")),(0,r.kt)("p",null,"\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u6bd4\u8f83\u7b80\u5355\uff0c\u65e0\u9700\u91cd\u65b0\u5236\u4f5c\u955c\u50cf\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-yaml"}),"apiVersion: apps/v1 # for versions before 1.8.0 use apps/v1beta1\nkind: Deployment\nmetadata:\n  name: test\n  namespace: test\n  labels:\n    app: test\nspec:\n  selector:\n    matchLabels:\n      app: test\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: test\n    spec:\n      containers:\n      - name: test\n        image: ubuntu:20.04\n        volumeMounts:\n        - name: localtime\n          mountPath: /etc/localtime\n      volumes:\n      - name: localtime\n        hostPath:\n          path: /etc/localtime\n\n")))}m.isMDXComponent=!0}}]);